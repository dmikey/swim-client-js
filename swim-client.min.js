!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(t.swim||(t.swim={})).client=e()}}(function(){return function e(t,r,n){function i(s,a){if(!r[s]){if(!t[s]){var p="function"==typeof require&&require;if(!a&&p)return p(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[s]={exports:{}};t[s][0].call(l.exports,function(e){var r=t[s][1][e];return i(r?r:e)},l,l.exports,e,t,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,r){"use strict";function n(){if(1===arguments.length){var e=arguments[0];if(void 0===e)return G;if(null===e)return W;if(e.isAttr||e.isSlot){var t=new D;return t.appendField(e),t.state()}return i(e)}return arguments.length>1?o(arguments):G}function i(e){return null===e?W:e.isRecord||e.isAttr||e.isSlot||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||e instanceof Uint8Array||e===W||e===G?e:Array.isArray(e)?o(e):"object"==typeof e?e.toRecon&&"function"==typeof e.toRecon?e.toRecon():s(e):G}function o(e){for(var t=new D,r=e.length,n=0;r>n;){var o=i(e[n]);o.isField?t.appendField(o):t.appendValue(o),n+=1}return t.state()}function s(e){var t,r,i,o=new D,s=e["@"];for(t in s)r=n(t),"string"==typeof r&&(i=n(s[t]),i.isAbsent||o.appendField(new w(r,i)));for(t in e)"@"!==t&&(r=n(t),r.isAbsent||(i=n(e[t]),i.isAbsent||o.appendField(new g(r,i))));return o.state()}function a(e){var t=new k(e),r=(new I).run(t);return r.state()}function p(){var e=new Z;return e.writeBlock(n.apply(null,arguments)),e.state()}function u(e){return void 0===e||null===e||e.isExtant?null:e.isAbsent?void 0:e.isRecord?e.isArray()?l(e):f(e):e}function l(e){for(var t=[],r=e.iterator();!r.isEmpty();){var n=u(r.head());t.push(n),r.step()}return t}function f(e){for(var t,r,n=e.iterator(),i={},o=null,s=0;!n.isEmpty();){var a=n.head();a.isField?(t=u(a.key),r=u(a.value),a.isAttr?(null===o&&(o={}),o[t]=r):i[t]=r):(r=u(a),i[s]=r),n.step(),s+=1}return null!==o&&(i["@"]=o),i}function d(e){if(void 0===e)return new Uint8Array(0);for(var t=new R,r=new k(e);!r.isEmpty();)t.appendBase64Char(r.head()),r.step();return t.state()}function c(e,t){return void 0===t&&(t=W),new w(n(e),n(t))}function h(e,t){return void 0===t&&(t=W),new g(n(e),n(t))}function y(){return new b([],{})}function v(){return new D}function m(e,t){if(e===t)return!0;if(e.isRecord&&t.isRecord)return e.equals(t);if(e.isField&&t.isField)return e.equals(t);if(e instanceof Uint8Array&&t instanceof Uint8Array&&e.length===t.length){for(var r=0,n=e.length;n>r&&e[r]===t[r];)r+=1;if(r===n)return!0}return!1}function b(e,t){if(void 0===t){t={};for(var r=0,n=e.length;n>r;){var i=e[r];i.isField&&(t[i.key]=i.value),r+=1}}var o=function(r){var n=t[r];return void 0===n&&"number"==typeof r&&(n=e[r]),n};return o.__proto__=b.prototype,Object.defineProperty(o,"items",{value:e}),Object.defineProperty(o,"index",{value:t}),o}function E(){}function w(e,t){E.call(this),Object.defineProperty(this,"key",{enumerable:!0,value:e}),void 0===t&&(t=W),Object.defineProperty(this,"value",{enumerable:!0,value:t})}function g(e,t){E.call(this),Object.defineProperty(this,"key",{enumerable:!0,value:e}),void 0===t&&(t=W),Object.defineProperty(this,"value",{enumerable:!0,value:t})}function O(e,t){Object.defineProperty(this,"items",{value:e}),Object.defineProperty(this,"index",{value:t||0,writable:!0})}function D(){Object.defineProperty(this,"items",{value:[]}),Object.defineProperty(this,"index",{value:{}})}function C(){Object.defineProperty(this,"items",{value:null,writable:!0}),Object.defineProperty(this,"index",{value:null,writable:!0}),Object.defineProperty(this,"value",{value:null,writable:!0})}function k(e,t){Object.defineProperty(this,"string",{value:e||""}),Object.defineProperty(this,"index",{value:t||0,writable:!0})}function x(){}function j(){Object.defineProperty(this,"string",{value:"",writable:!0})}function R(){Object.defineProperty(this,"buffer",{value:null,writable:!0}),Object.defineProperty(this,"offset",{value:0,writable:!0}),Object.defineProperty(this,"aliased",{value:!0,writable:!0}),Object.defineProperty(this,"p",{value:0,writable:!0}),Object.defineProperty(this,"q",{value:0,writable:!0}),Object.defineProperty(this,"r",{value:0,writable:!0}),Object.defineProperty(this,"s",{value:0,writable:!0})}function P(e){return 32===e||9===e}function S(e){return 10===e||13===e}function F(e){return P(e)||S(e)}function A(e){return e>=65&&90>=e||95===e||e>=97&&122>=e||e>=192&&214>=e||e>=216&&246>=e||e>=248&&767>=e||e>=880&&893>=e||e>=895&&8191>=e||e>=8204&&8205>=e||e>=8304&&8591>=e||e>=11264&&12271>=e||e>=12289&&55295>=e||e>=63744&&64975>=e||e>=65008&&65533>=e||e>=65536&&983039>=e}function _(e){return 45===e||e>=48&&57>=e||e>=65&&90>=e||95===e||e>=97&&122>=e||183===e||e>=192&&214>=e||e>=216&&246>=e||e>=248&&893>=e||e>=895&&8191>=e||e>=8204&&8205>=e||e>=8255&&8256>=e||e>=8304&&8591>=e||e>=11264&&12271>=e||e>=12289&&55295>=e||e>=63744&&64975>=e||e>=65008&&65533>=e||e>=65536&&983039>=e}function T(e){return e>=48&&57>=e||e>=65&&90>=e||e>=97&&122>=e||43===e||45===e||47===e||95===e}function I(e){x.call(this),this.value=e||new q}function q(e,t,r,n){x.call(this),this.builder=e||null,this.key=t||null,this.value=r||null,this.s=n||1}function N(e,t,r){x.call(this),this.ident=e||new B,this.value=t||new q,this.s=r||1}function U(e,t,r,n){x.call(this),this.builder=e||null,this.field=t||null,this.value=r||null,this.s=n||1}function M(e,t,r,n){x.call(this),this.builder=e||null,this.field=t||null,this.value=r||null,this.s=n||1}function H(e,t,r,n){x.call(this),this.builder=e||null,this.key=t||null,this.value=r||null,this.s=n||1}function L(e,t,r,n){x.call(this),this.builder=e||null,this.text=t||null,this.value=r||null,this.s=n||1}function B(e,t){x.call(this),this.builder=e||null,this.s=t||1}function z(e,t){x.call(this),this.text=e||null,this.s=t||1}function V(e,t){x.call(this),this.builder=e||null,this.s=t||1}function $(e,t){x.call(this),this.data=e||null,this.s=t||1}function Z(e){Object.defineProperty(this,"builder",{value:e||new j})}b.prototype=Object.create(Function.prototype),b.prototype.constructor=b,Object.defineProperty(b.prototype,"isRecord",{enumerable:!0,value:!0}),Object.defineProperty(b.prototype,"size",{enumerable:!0,get:function(){return this.items.length}}),b.prototype.isEmpty=function(){return 0===this.items.length},b.prototype.isArray=function(){return this.items.length>=0&&0===Object.getOwnPropertyNames(this.index).length},b.prototype.isBlockSafe=function(){for(var e=this.iterator();!e.isEmpty();)if(e.next().isAttr)return!1;return!0},b.prototype.isMarkupSafe=function(){var e=this.iterator();if(e.isEmpty()||!e.next().isAttr)return!1;for(;!e.isEmpty();)if(e.next().isAttr)return!1;return!0},b.prototype.contains=function(e){return void 0!==this(e)},b.prototype.head=function(){return this.items.length>0?this.items[0]:G},b.prototype.tail=function(){return new b(this.items.slice(1))},b.prototype.body=function(){return new b(this.items.slice(0,-1))},b.prototype.foot=function(){return this.items.length>0?this.items[this.items.length-1]:G},b.prototype.target=function(){for(var e=this.iterator();!e.isEmpty();){var t=e.next();if(!t.isField)return t}return G},b.prototype.concat=function(){var e=new D;e.appendRecord(this);var t=n.apply(null,arguments);return t.isRecord?e.appendRecord(t):e.appendValue(t),e.state()},b.prototype.iterator=function(){return new O(this.items)},b.prototype.forEach=function(e){for(var t=this.iterator();!t.isEmpty();)e(t.next())},b.prototype.equals=function(e){for(var t=this.iterator(),r=e.iterator();!t.isEmpty()&&!r.isEmpty();)if(!m(t.next(),r.next()))return!1;return t.isEmpty()&&r.isEmpty()},b.prototype.toString=function(){var e=new Z;return e.writeRecord(this),e.state()},Object.defineProperty(E.prototype,"isField",{enumerable:!0,value:!0}),Object.defineProperty(E.prototype,"isAttr",{enumerable:!0,value:!1}),Object.defineProperty(E.prototype,"isSlot",{enumerable:!0,value:!1}),w.prototype=Object.create(E.prototype),w.prototype.constructor=w,Object.defineProperty(w.prototype,"isAttr",{enumerable:!0,value:!0}),w.prototype.equals=function(e){return e.isAttr&&m(this.key,e.key)&&m(this.value,e.value)},w.prototype.toString=function(){var e=new Z;return e.writeAttr(this),e.state()},g.prototype=Object.create(E.prototype),g.prototype.constructor=g,Object.defineProperty(g.prototype,"isSlot",{enumerable:!0,value:!0}),g.prototype.equals=function(e){return e.isSlot&&m(this.key,e.key)&&m(this.value,e.value)},g.prototype.toString=function(){var e=new Z;return e.writeItem(this),e.state()};var W={};Object.defineProperty(W,"isExtant",{enumerable:!0,value:!0});var G={};Object.defineProperty(G,"isAbsent",{enumerable:!0,value:!0}),O.prototype.isEmpty=function(){return this.index>=this.items.length},O.prototype.head=function(){if(this.index>=this.items.length)throw"head of empty iterator";return this.items[this.index]},O.prototype.step=function(){if(this.index>=this.items.length)throw"empty iterator step";this.index+=1},O.prototype.next=function(){if(this.index>=this.items.length)return null;var e=this.items[this.index];return this.index+=1,e},O.prototype.dup=function(){return new O(this.items,this.index)},O.prototype.toRecord=function(){return new b(this.items.slice(this.index))},D.prototype.appendField=function(e){this.items.push(e),this.index[e.key]=e.value},D.prototype.appendValue=function(e){this.items.push(e)},D.prototype.appendRecord=function(e){for(var t=e.iterator();!t.isEmpty();){var r=t.next();r.isField?this.appendField(r):this.appendValue(r)}},D.prototype.attr=function(e,t){return this.appendField(c(e,t)),this},D.prototype.slot=function(e,t){return this.appendField(h(e,t)),this},D.prototype.item=function(e){return this.appendValue(i(e)),this},D.prototype.state=function(){return new b(this.items,this.index)},C.prototype.appendField=function(e){null===this.items&&(this.items=[],this.index={},null!==this.value&&(this.items.push(this.value),this.value=null)),this.items.push(e),this.index[e.key]=e.value},C.prototype.appendValue=function(e){null!==this.items?this.items.push(e):null===this.value?this.value=e:(this.items=[],this.index={},this.items.push(this.value),this.value=null,this.items.push(e))},C.prototype.state=function(){return null!==this.value?this.value:null!==this.items?new b(this.items,this.index):G},k.prototype.isDone=function(){return!1},k.prototype.isEmpty=function(){return this.index>=this.string.length},k.prototype.head=function(){var e=this.string.charCodeAt(this.index);if(55295>=e||e>=57344)return e;if(56319>=e&&this.index+1<this.string.length){var t=this.string.charCodeAt(this.index+1);return t>=56320&&57343>=t?((1023&e)<<10|1023&t)+65536:65533}return 65533},k.prototype.step=function(){var e=this.string.charCodeAt(this.index);if(55295>=e||e>=57344)this.index+=1;else if(56319>=e&&this.index+1<this.string.length){var t=this.string.charCodeAt(this.index+1);this.index+=t>=56320&&57343>=t?2:1}else this.index+=1},k.Done={isDone:function(){return!0},isEmpty:function(){return!0},head:function(){throw"head of empty iterator"},step:function(){throw"empty iterator step"}},k.Done.prototype=Object.create(k.prototype),x.prototype.isCont=function(){return!0},x.prototype.isDone=function(){return!1},x.prototype.isError=function(){return!1},x.prototype.feed=function(e){return this},x.prototype.run=function(e){for(var t=this;!e.isEmpty()&&t.isCont();)t=t.feed(e);return e.isEmpty()&&!e.isDone()&&t.isCont()&&(t=t.feed(k.Done)),t},x.Done=function(e){x.call(this),this.value=e},x.Done.prototype=Object.create(x.prototype),x.Done.prototype.constructor=x.Done,x.Done.prototype.isCont=function(){return!1},x.Done.prototype.isDone=function(){return!0},x.Done.prototype.feed=function(e){return this},x.Done.prototype.state=function(){return this.value},x.Error=function(e){x.call(this),this.error=e},x.Error.prototype=Object.create(x.prototype),x.Error.prototype.constructor=x.Error,x.Error.prototype.isCont=function(){return!1},x.Error.prototype.isError=function(){return!0},x.Error.prototype.feed=function(e){return this},x.Error.prototype.state=function(){throw this.error},x.unexpectedEOF=new x.Error("unexpected end of input"),j.prototype.append=function(e){if(e>=0&&55295>=e||e>=57344&&65535>=e)this.string+=String.fromCharCode(e);else if(e>=65536&&1114111>=e){var t=e-65536;this.string+=String.fromCharCode(55296|t>>>10,56320|1023&t)}else this.string+=String.fromCharCode(65533)},j.prototype.appendString=function(e){for(var t=new k(e);!t.isEmpty();)this.append(t.head()),t.step()},j.prototype.state=function(){return this.string},R.prototype.prepare=function(e){function t(e,t){var r=Math.max(e,t)-1;return r|=r>>1,r|=r>>2,r|=r>>4,r|=r>>8,r+1}if(this.aliased||e>this.buffer.length){var r=new Uint8Array(t(256,e));this.buffer&&r.set(this.buffer),this.buffer=r,this.aliased=!1}},R.prototype.appendByte=function(e){this.prepare(this.offset+1),this.buffer[this.offset]=e,this.offset+=1},R.prototype.decodeBase64Digit=function(e){return e>=65&&90>=e?e-65:e>=97&&122>=e?e-71:e>=48&&57>=e?e+4:43===e||45===e?62:47===e||95===e?63:void 0},R.prototype.decodeBase64Quantum=function(){var e=this.decodeBase64Digit(this.p),t=this.decodeBase64Digit(this.q);if(61!==this.r){var r=this.decodeBase64Digit(this.r);if(61!==this.s){var n=this.decodeBase64Digit(this.s);this.appendByte(e<<2|t>>>4),this.appendByte(t<<4|r>>>2),this.appendByte(r<<6|n)}else this.appendByte(e<<2|t>>>4),this.appendByte(t<<4|r>>>2)}else{if(61!==this.s)throw"incomplete base64 quantum";this.appendByte(e<<2|t>>>4)}},R.prototype.appendBase64Char=function(e){0===this.p?this.p=e:0===this.q?this.q=e:0===this.r?this.r=e:(this.s=e,this.decodeBase64Quantum(),this.s=0,this.r=0,this.q=0,this.p=0)},R.prototype.state=function(e){if(this.buffer){if(this.buffer.length!==this.offset){var t=new Uint8Array(this.offset);t.set(this.buffer.subarray(0,this.offset)),this.buffer=t}}else this.buffer=new Uint8Array(0);return this.aliased=!0,this.buffer},I.prototype=Object.create(x.prototype),I.prototype.constructor=I,I.prototype.feed=function(e){for(var t=this.value;(!e.isEmpty()||e.isDone())&&t.isCont();)t=t.feed(e);if(t.isError())return t;if(t.isDone()){if(!e.isEmpty())return new x.Error({found:e.head()});if(e.isDone())return t}return new I(t)},q.prototype=Object.create(x.prototype),q.prototype.constructor=q,q.prototype.feed=function(e){for(var t=0,r=this.s,n=this.value,i=this.key,o=this.builder||new C;!e.isEmpty()||e.isDone();){if(1===r){for(;!e.isEmpty()&&(t=e.head(),F(t));)e.step();if(e.isEmpty()){if(e.isDone())return new x.Done(o.state())}else{if(!(64===t||123===t||91===t||A(t)||34===t||45===t||t>=48&&57>=t||37===t))return new x.Error({expected:"block value",found:t});r=2}}if(2===r){for(i=i||new U;(!e.isEmpty()||e.isDone())&&i.isCont();)i=i.feed(e);if(i.isDone())r=3;else if(i.isError())return i}if(3===r){for(;!e.isEmpty()&&(t=e.head(),P(t));)e.step();if(e.isEmpty()){if(e.isDone())return o.appendValue(i.state()),new x.Done(o.state())}else 58===t?(e.step(),r=4):(o.appendValue(i.state()),i=null,r=6)}if(4===r){for(;!e.isEmpty()&&P(e.head());)e.step();if(e.isEmpty()){if(e.isDone())return o.appendField(new g(i.state())),new x.Done(o.state())}else r=5}if(5===r){for(n=n||new U;(!e.isEmpty()||e.isDone())&&n.isCont();)n=n.feed(e);if(n.isDone())o.appendField(new g(i.state(),n.state())),i=null,n=null,r=6;else if(n.isError())return n}if(6===r){for(;!e.isEmpty()&&(t=e.head(),P(t));)e.step();if(e.isEmpty()){if(e.isDone())return new x.Done(o.state())}else{if(44!==t&&59!==t&&!S(t))return new x.Done(o.state());e.step(),r=1}}}return new q(o,i,n,r)},N.prototype=Object.create(x.prototype),N.prototype.constructor=N,N.prototype.feed=function(e){var t=0,r=this.s,n=this.value,i=this.ident;if(1===r)if(e.isEmpty()||(t=e.head(),64!==t)){if(!e.isEmpty())return new x.Error({expected:"'@'",found:t});if(e.isDone())return x.unexpectedEOF}else e.step(),r=2;if(2===r)if(i=i.feed(e),i.isDone())r=3;else if(i.isError())return i;if(3===r)if(e.isEmpty()||40!==e.head()){if(!e.isEmpty()||e.isDone())return new x.Done(new w(i.state()))}else e.step(),r=4;if(4===r){for(;!e.isEmpty()&&(t=e.head(),F(t));)e.step();if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else{if(41===t)return e.step(),new x.Done(new w(i.state()));r=5}}if(5===r){for(;(!e.isEmpty()||e.isDone())&&n.isCont();)n=n.feed(e);if(n.isDone())r=6;else if(n.isError())return n}if(6===r){for(;!e.isEmpty()&&(t=e.head(),F(t));)e.step();if(!e.isEmpty())return 41===t?(e.step(),new x.Done(new w(i.state(),n.state()))):new x.Error({expected:"')'",found:t});if(e.isDone())return x.unexpectedEOF}return new N(i,n,r)},U.prototype=Object.create(x.prototype),U.prototype.constructor=U,U.prototype.feed=function(e){for(var t=0,r=this.s,n=this.value,i=this.field,o=this.builder;!e.isEmpty()||e.isDone();){if(1===r)if(e.isEmpty()){if(e.isDone())return new x.Done(o?o.state():G)}else if(t=e.head(),64===t)i=new N,r=2;else if(123===t)o=o||new D,n=new H(o),r=5;else if(91===t)o=o||new D,n=new L(o),r=5;else if(A(t))n=new B,r=4;else if(34===t)n=new z,r=4;else if(45===t||t>=48&&57>=t)n=new V,r=4;else{if(37!==t)return new x.Done(o?o.state():G);n=new $,r=4}if(2===r){for(;(!e.isEmpty()||e.isDone())&&i.isCont();)i=i.feed(e);if(i.isDone())o=o||new C,o.appendField(i.state()),i=null,r=3;else if(i.isError())return i}if(3===r){for(;!e.isEmpty()&&P(e.head());)e.step();if(e.isEmpty()){if(e.isDone())return new x.Done(o.state())}else r=1}if(4===r){for(;(!e.isEmpty()||e.isDone())&&n.isCont();)n=n.feed(e);if(n.isDone())o=o||new C,o.appendValue(n.state()),n=null,r=6;else if(n.isError())return n}if(5===r){for(;(!e.isEmpty()||e.isDone())&&n.isCont();)n=n.feed(e);if(n.isDone())n=null,r=6;else if(n.isError())return n}if(6===r){for(;!e.isEmpty()&&P(e.head());)e.step();if(e.isEmpty()||64!==e.head())return new x.Done(o.state());r=1}}return new U(o,i,n,r)},M.prototype=Object.create(x.prototype),M.prototype.constructor=M,M.prototype.feed=function(e){var t=0,r=this.s,n=this.value,i=this.field,o=this.builder;if(1===r)if(e.isEmpty()){if(e.isDone())return new x.Done(o?o.state():W)}else if(t=e.head(),64===t)i=new N,r=2;else if(123===t)o?(n=new H(o),r=5):(n=new H,r=4);else{if(91!==t)return new x.Done(o?o.state():W);o?(n=new L(o),r=5):(n=new L,r=4)}if(2===r){for(;(!e.isEmpty()||e.isDone())&&i.isCont();)i=i.feed(e);if(i.isDone())o=o||new C,o.appendField(i.state()),i=null,r=3;else if(i.isError())return i}if(3===r)if(e.isEmpty()){if(e.isDone())return new x.Done(o.state())}else if(t=e.head(),123===t)n=new H(o),r=5;else{if(91!==t)return new x.Done(o.state());n=new L(o),r=5}if(4===r){for(;(!e.isEmpty()||e.isDone())&&n.isCont();)n=n.feed(e);if(n.isDone())return o=o||new C,o.appendValue(n.state()),new x.Done(o.state());if(n.isError())return n}if(5===r){for(;(!e.isEmpty()||e.isDone())&&n.isCont();)n=n.feed(e);if(n.isDone())return new x.Done(o.state());if(n.isError())return n}return new M(o,i,n,r)},H.prototype=Object.create(x.prototype),H.prototype.constructor=H,H.prototype.feed=function(e){var t=0,r=this.s,n=this.value,i=this.key,o=this.builder||new D;if(1===r)if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else{if(t=e.head(),123!==t)return new x.Error({expected:"'{'",found:t});e.step(),r=2}for(;!e.isEmpty()||e.isDone();){if(2===r){for(;!e.isEmpty()&&(t=e.head(),F(t));)e.step();if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else{if(125===t)return e.step(),new x.Done(o.state());r=3}}if(3===r){for(i=i||new U;(!e.isEmpty()||e.isDone())&&i.isCont();)i=i.feed(e);if(i.isDone())r=4;else if(i.isError())return i}if(4===r){for(;!e.isEmpty()&&(t=e.head(),P(t));)e.step();if(e.isEmpty()){if(e.isDone())return o.appendValue(i.state()),new x.Done(o.state())}else 58===t?(e.step(),r=5):(o.appendValue(i.state()),i=null,r=7)}if(5===r){for(;!e.isEmpty()&&P(e.head());)e.step();if(e.isEmpty()){if(e.isDone())return o.appendField(new g(i.state())),new x.Done(o.state())}else r=6}if(6===r){for(n=n||new U;(!e.isEmpty()||e.isDone())&&n.isCont();)n=n.feed(e);if(n.isDone())o.appendField(new g(i.state(),n.state())),i=null,n=null,r=7;else if(n.isError())return n}if(7===r){for(;!e.isEmpty()&&(t=e.head(),P(t));)e.step();if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else{if(44!==t&&59!==t&&!S(t))return 125===t?(e.step(),new x.Done(o.state())):new x.Error({expected:"'}', ';', ',', or newline",found:t});e.step(),r=2}}}return new H(o,i,n,r)},L.prototype=Object.create(x.prototype),L.prototype.constructor=L,L.prototype.feed=function(e){var t=0,r=this.s,n=this.value,i=this.text,o=this.builder;if(1===r)if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else{if(t=e.head(),91!==t)return new x.Error({expected:"'['",found:t});e.step(),r=2}for(;!e.isEmpty()||e.isDone();){if(2===r){for(;!e.isEmpty()&&(t=e.head(),64!==t&&91!==t&&92!==t&&93!==t&&123!==t&&125!==t);)e.step(),i=i||new j,i.append(t);if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else{if(93===t)return e.step(),o=o||new D,i&&o.appendValue(i.state()),new x.Done(o.state());64===t?(o=o||new D,i&&(o.appendValue(i.state()),i=null),n=new M,r=3):123===t?(o=o||new D,i&&(o.appendValue(i.state()),i=null),n=new H(o),r=4):91===t?(o=o||new D,i&&(o.appendValue(i.state()),i=null),n=new L(o),r=4):92===t?(e.step(),r=5):new x.Error({found:t})}}if(3===r){for(;(!e.isEmpty()||e.isDone())&&n.isCont();)n=n.feed(e);if(n.isDone())o.appendValue(n.state()),n=null,r=2;else if(n.isError())return n}if(4===r){for(;(!e.isEmpty()||e.isDone())&&n.isCont();)n=n.feed(e);if(n.isDone())n=null,r=2;else if(n.isError())return n}if(5===r)if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else if(t=e.head(),i=i||new j,34===t||47===t||64===t||91===t||92===t||93===t||123===t||125===t)e.step(),i.append(t),r=2;else if(98===t)e.step(),i.append(8),r=2;else if(102===t)e.step(),i.append(12),r=2;else if(110===t)e.step(),i.append(10),r=2;else if(114===t)e.step(),i.append(13),r=2;else{if(116!==t)return new x.Error({expected:"escape character",found:t});e.step(),i.append(9),r=2}}return new L(o,i,n,r)},B.prototype=Object.create(x.prototype),B.prototype.constructor=B,B.prototype.feed=function(e){var t=0,r=this.s,n=this.builder;if(1===r)if(!e.isEmpty()&&(t=e.head(),A(t)))n=n||new j,e.step(),n.append(t),r=2;else{if(!e.isEmpty())return new x.Error({expected:"identitifer",found:t});if(e.isDone())return x.unexpectedEOF}if(2===r){for(;!e.isEmpty()&&(t=e.head(),_(t));)e.step(),n.append(t);if(!e.isEmpty()||e.isDone()){var i=n.state();return"true"===i?i=!0:"false"===i&&(i=!1),new x.Done(i)}}return new B(n,r)},z.prototype=Object.create(x.prototype),z.prototype.constructor=z,z.prototype.feed=function(e){var t=0,r=this.s,n=this.text;if(1===r)if(e.isEmpty()||(t=e.head(),34!==t)){if(!e.isEmpty())return new x.Error({expected:"'\"'",found:t});if(e.isDone())return x.unexpectedEOF}else e.step(),r=2;for(;!e.isEmpty()||e.isDone();){if(2===r){for(n=n||new j;!e.isEmpty()&&(t=e.head(),34!==t&&92!==t);)e.step(),n.append(t);if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else{if(34===t)return e.step(),new x.Done(n.state());92===t&&(e.step(),r=3)}}if(3===r)if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else if(t=e.head(),34===t||47===t||64===t||91===t||92===t||93===t||123===t||125===t)e.step(),n.append(t),r=2;else if(98===t)e.step(),n.append(8),r=2;else if(102===t)e.step(),n.append(12),r=2;else if(110===t)e.step(),n.append(10),r=2;else if(114===t)e.step(),n.append(13),r=2;else{if(116!==t)return new x.Error({expected:"escape character",found:t});e.step(),n.append(9),r=2}}return new z(n,r)},V.prototype=Object.create(x.prototype),V.prototype.constructor=V,V.prototype.feed=function(e){var t=0,r=this.s,n=this.builder||new j;if(1===r)if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else t=e.head(),45===t&&(e.step(),n.append(t)),r=2;if(2===r)if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else if(t=e.head(),48===t)e.step(),n.append(t),r=4;else{if(!(t>=49&&57>=t))return new x.Error({expected:"digit",found:t});e.step(),n.append(t),r=3}if(3===r){for(;!e.isEmpty()&&(t=e.head(),t>=48&&57>=t);)e.step(),n.append(t);if(e.isEmpty()){if(e.isDone())return new x.Done(Number(n.state()))}else r=4}if(4===r)if(e.isEmpty()){if(e.isDone())return new x.Done(Number(n.state()))}else if(t=e.head(),46===t)e.step(),n.append(t),r=5;else{if(69!==t&&101!==t)return new x.Done(Number(n.state()));e.step(),n.append(t),r=8}if(5===r)if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else{if(t=e.head(),!(t>=48&&57>=t))return new x.Error({expected:"digit",found:t});e.step(),n.append(t),r=6}if(6===r){for(;!e.isEmpty()&&(t=e.head(),t>=48&&57>=t);)e.step(),n.append(t);if(e.isEmpty()){if(e.isDone())return new x.Done(Number(n.state()))}else r=7}if(7===r){if(t=e.head(),69!==t&&101!==t)return new x.Done(Number(n.state()));e.step(),n.append(t),r=8}if(8===r)if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else t=e.head(),(43===t||45===t)&&(e.step(),n.append(t)),r=9;if(9===r)if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else{if(t=e.head(),!(t>=48&&57>=t))return new x.Error({expected:"digit",found:t});e.step(),n.append(t),r=10}if(10===r){for(;!e.isEmpty()&&(t=e.head(),t>=48&&57>=t);)e.step(),n.append(t);if(!e.isEmpty()||e.isDone())return new x.Done(Number(n.state()))}return new V(n,r)},$.prototype=Object.create(x.prototype),$.prototype.constructor=$,$.prototype.feed=function(e){var t=0,r=this.s,n=this.data||new R;if(1===r)if(e.isEmpty()||(t=e.head(),37!==t)){if(!e.isEmpty())return new x.Error({expected:"'%'",found:t});if(e.isDone())return x.unexpectedEOF}else e.step(),r=2;for(;!e.isEmpty()||e.isDone();){if(2===r)if(!e.isEmpty()&&(t=e.head(),T(t)))e.step(),n.appendBase64Char(t),r=3;else if(!e.isEmpty()||e.isDone())return new x.Done(n.state());if(3===r)if(!e.isEmpty()&&(t=e.head(),T(t)))e.step(),n.appendBase64Char(t),r=4;else{if(!e.isEmpty())return new x.Error({expected:"base64 digit",found:t});if(e.isDone())return x.unexpectedEOF}if(4===r)if(!e.isEmpty()&&(t=e.head(),T(t)||61===t))e.step(),n.appendBase64Char(t),r=61!==t?5:6;else{if(!e.isEmpty())return new x.Error({expected:"base64 digit",found:t});if(e.isDone())return x.unexpectedEOF}if(5===r)if(!e.isEmpty()&&(t=e.head(),T(t)||61===t)){if(e.step(),n.appendBase64Char(t),61===t)return new x.Done(n.state());r=2}else{if(!e.isEmpty())return new x.Error({expected:"base64 digit",found:t});if(e.isDone())return x.unexpectedEOF}else if(6===r){if(!e.isEmpty()&&(t=e.head(),61===t))return e.step(),n.appendBase64Char(t),new x.Done(n.state());if(!e.isEmpty())return new x.Error({expected:"'='",found:t});if(e.isDone())return x.unexpectedEOF}}return new $(n,r)},Z.prototype.writeValue=function(e){e.isRecord?this.writeRecord(e):"string"==typeof e?this.writeText(e):"number"==typeof e?this.writeNumber(e):"boolean"==typeof e?this.writeBool(e):e instanceof Uint8Array&&this.writeData(e)},Z.prototype.writeAttr=function(e){this.builder.append(64),this.writeIdent(e.key),e.value.isExtant||(this.builder.append(40),this.writeBlock(e.value),this.builder.append(41))},Z.prototype.writeItem=function(e){e.isField?(this.writeValue(e.key),this.builder.append(58),e.value.isExtant||this.writeValue(e.value)):this.writeValue(e)},Z.prototype.writeBlock=function(e){e.isRecord?e.isEmpty()?(this.builder.append(123),this.builder.append(125)):this.writeItems(e,e.isBlockSafe(),!1):this.writeValue(e)},Z.prototype.writeRecord=function(e){e.isEmpty()?(this.builder.append(123),this.builder.append(125)):this.writeItems(e,!1,!1)},Z.prototype.writeItems=function(e,t,r){for(var n=e.iterator(),i=!1,o=!1,s=!0;!n.isEmpty();){var a=n.head();n.step(),o&&a.isAttr&&(i&&(this.builder.append(125),i=!1),this.builder.append(93),o=!1),a.isAttr?(i?(this.builder.append(125),i=!1):o&&(this.builder.append(93),o=!1),this.writeAttr(a),s=!1):o&&"string"==typeof a?(i&&(this.builder.append(125),i=!1),this.writeMarkupText(a)):i?(s?s=!1:this.builder.append(44),this.writeItem(a)):o?a.isRecord&&a.isMarkupSafe()?(this.writeItems(a,!1,!0),n.isEmpty()||"string"!=typeof n.head()?n.isEmpty()||n.head().isAttr?(this.builder.append(93),o=!1):(this.builder.append(123),i=!0,s=!0):(this.writeMarkupText(n.head()),n.step())):(this.builder.append(123),this.writeItem(a),i=!0,s=!1):"string"!=typeof a||n.isEmpty()||n.head().isField||"string"==typeof n.head()||"boolean"==typeof n.head()?t&&!i?(s?s=!1:this.builder.append(44),this.writeItem(a)):r&&"string"==typeof a&&n.isEmpty()?(this.builder.append(91),this.writeMarkupText(a),this.builder.append(93)):r||a.isField||a.isRecord||!(!s&&n.isEmpty()||!n.isEmpty()&&n.head().isAttr)?(this.builder.append(123),this.writeItem(a),i=!0,s=!1):(!s&&("string"==typeof a&&this.isIdent(a)||"number"==typeof a||"boolean"==typeof a)&&this.builder.append(32),this.writeValue(a)):(this.builder.append(91),this.writeMarkupText(a),o=!0)}i?this.builder.append(125):o&&this.builder.append(93)},Z.prototype.isIdent=function(e){var t=new k(e);if(t.isEmpty()||!A(t.head()))return!1;for(t.step();!t.isEmpty()&&_(t.head());)t.step();return t.isEmpty()},Z.prototype.writeText=function(e){this.isIdent(e)?this.writeIdent(e):this.writeString(e)},Z.prototype.writeIdent=function(e){this.builder.appendString(e)},Z.prototype.writeString=function(e){var t=new k(e);for(this.builder.append(34);!t.isEmpty();){var r=t.head();switch(r){case 34:case 92:this.builder.append(92),this.builder.append(r);break;case 8:this.builder.append(92),this.builder.append(98);break;case 12:this.builder.append(92),this.builder.append(102);break;case 10:this.builder.append(92),this.builder.append(110);break;case 13:this.builder.append(92),this.builder.append(114);break;case 9:this.builder.append(92),this.builder.append(116);break;default:this.builder.append(r)}t.step()}this.builder.append(34)},Z.prototype.writeMarkupText=function(e){for(var t=new k(e);!t.isEmpty();){var r=t.head();switch(r){case 64:case 91:case 92:case 93:case 123:case 125:this.builder.append(92),this.builder.append(r);break;default:this.builder.append(r)}t.step()}},Z.prototype.writeNumber=function(e){this.builder.appendString(e.toString())},Z.prototype.writeBool=function(e){this.builder.appendString(e.toString())},Z.prototype.writeData=function(e){function t(e){return e>=0&&26>e?e+65:e>=26&&52>e?e+71:e>=52&&62>e?e-4:62===e?43:63===e?47:void 0}this.builder.append(37);for(var r,n,i,o=0,s=e.length;s>o+2;)r=e[o],n=e[o+1],i=e[o+2],this.builder.append(t(r>>>2)),this.builder.append(t(63&(r<<4|n>>>4))),this.builder.append(t(63&(n<<2|i>>>6))),this.builder.append(t(63&i)),o+=3;s>o+1?(r=e[o],n=e[o+1],this.builder.append(t(r>>>2)),this.builder.append(t(63&(r<<4|n>>>4))),this.builder.append(t(n<<2&63)),this.builder.append(61),o+=2):s>o&&(r=e[o],this.builder.append(t(r>>>2)),this.builder.append(t(r<<4&63)),this.builder.append(61),this.builder.append(61),o+=1)},Z.prototype.state=function(){return this.builder.state()},t.exports=function(){return n.apply(null,arguments)},r=t.exports,r.parse=a,r.stringify=p,r.objectify=u,r.Record=b,r.Field=E,r.Attr=w,r.Slot=g,r.attr=c,r.slot=h,r.base64=d,r.extant=W,r.absent=G,r.empty=y,r.builder=v,r.compare=m},{}],2:[function(e,t,r){"use strict";function n(e){if(e.isRecord){var t=e.head();if(t.isField)switch(t.key){case"event":return f.decode(e);case"command":return d.decode(e);case"sync":return c.decode(e);case"synced":return h.decode(e);case"link":return y.decode(e);case"linked":return v.decode(e);case"unlink":return m.decode(e);case"unlinked":return b.decode(e);case"get":return E.decode(e);case"put":return w.decode(e);case"state":return g.decode(e)}}}function i(e){return e.encode()}function o(e){return n(O.parse(e))}function s(e){return O.stringify(i(e))}function a(){}function p(){a.call(this)}function u(){a.call(this)}function l(){a.call(this)}function f(e,t,r,n){l.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e}),Object.defineProperty(this,"lane",{enumerable:!0,value:t}),Object.defineProperty(this,"via",{enumerable:!0,value:r||O.absent}),Object.defineProperty(this,"body",{enumerable:!0,value:n||O.empty()})}function d(e,t,r,n){l.call(this),
Object.defineProperty(this,"node",{enumerable:!0,value:e}),Object.defineProperty(this,"lane",{enumerable:!0,value:t}),Object.defineProperty(this,"via",{enumerable:!0,value:r||O.absent}),Object.defineProperty(this,"body",{enumerable:!0,value:n||O.empty()})}function c(e,t){p.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e}),Object.defineProperty(this,"lane",{enumerable:!0,value:t})}function h(e,t){u.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e}),Object.defineProperty(this,"lane",{enumerable:!0,value:t})}function y(e,t){p.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e}),Object.defineProperty(this,"lane",{enumerable:!0,value:t})}function v(e,t){u.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e}),Object.defineProperty(this,"lane",{enumerable:!0,value:t})}function m(e,t){p.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e}),Object.defineProperty(this,"lane",{enumerable:!0,value:t})}function b(e,t){u.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e}),Object.defineProperty(this,"lane",{enumerable:!0,value:t})}function E(e){p.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e})}function w(e,t){p.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e}),Object.defineProperty(this,"body",{enumerable:!0,value:t||O.empty()})}function g(e,t){u.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e}),Object.defineProperty(this,"body",{enumerable:!0,value:t||O.empty()})}var O=e("recon-js");Object.defineProperty(a.prototype,"isRequest",{value:!1}),Object.defineProperty(a.prototype,"isResponse",{value:!1}),Object.defineProperty(a.prototype,"isMessage",{value:!1}),Object.defineProperty(a.prototype,"isEventMessage",{value:!1}),Object.defineProperty(a.prototype,"isCommandMessage",{value:!1}),Object.defineProperty(a.prototype,"isSyncRequest",{value:!1}),Object.defineProperty(a.prototype,"isSyncedResponse",{value:!1}),Object.defineProperty(a.prototype,"isLinkRequest",{value:!1}),Object.defineProperty(a.prototype,"isLinkedResponse",{value:!1}),Object.defineProperty(a.prototype,"isUnlinkRequest",{value:!1}),Object.defineProperty(a.prototype,"isUnlinkedResponse",{value:!1}),Object.defineProperty(a.prototype,"isGetRequest",{value:!1}),Object.defineProperty(a.prototype,"isPutRequest",{value:!1}),Object.defineProperty(a.prototype,"isStateResponse",{value:!1}),p.prototype=Object.create(a.prototype),p.prototype.constructor=p,Object.defineProperty(p.prototype,"isRequest",{value:!0}),u.prototype=Object.create(a.prototype),u.prototype.constructor=u,Object.defineProperty(p.prototype,"isResponse",{value:!0}),l.prototype=Object.create(a.prototype),l.prototype.constructor=l,Object.defineProperty(p.prototype,"isMessage",{value:!0}),f.prototype=Object.create(l.prototype),f.prototype.constructor=f,Object.defineProperty(f.prototype,"isEventMessage",{value:!0}),f.prototype.encode=function(){var e=O.builder(),t=O.builder();return t.slot("node",this.node),t.slot("lane",this.lane),this.via.isAbsent||t.slot("via",this.via),e.attr("event",t.state()),e.appendRecord(this.body),e.state()},f.decode=function(e){var t="",r="",n=O.absent,i=e.tail(),o=e.head();if(o.value.isRecord)for(var s=o.value.iterator(),a=0;!s.isEmpty();){var p=s.next();if(p.isField)switch(p.key){case"node":t=p.value;break;case"lane":r=p.value;break;case"via":n=p.value}else switch(a){case 0:t=p;break;case 1:r=p;break;case 2:n=p}a+=1}return new f(t,r,n,i)},d.prototype=Object.create(l.prototype),d.prototype.constructor=d,Object.defineProperty(d.prototype,"isCommandMessage",{value:!0}),d.prototype.encode=function(){var e=O.builder(),t=O.builder();return t.slot("node",this.node),t.slot("lane",this.lane),this.via.isAbsent||t.slot("via",this.via),e.attr("command",t.state()),e.appendRecord(this.body),e.state()},d.decode=function(e){var t="",r="",n=O.absent,i=e.tail(),o=e.head();if(o.value.isRecord)for(var s=o.value.iterator(),a=0;!s.isEmpty();){var p=s.next();if(p.isField)switch(p.key){case"node":t=p.value;break;case"lane":r=p.value;break;case"via":n=p.value}else switch(a){case 0:t=p;break;case 1:r=p;break;case 2:n=p}a+=1}return new d(t,r,n,i)},c.prototype=Object.create(p.prototype),c.prototype.constructor=c,Object.defineProperty(c.prototype,"isSyncRequest",{value:!0}),c.prototype.encode=function(){return O(O.attr("sync",O(O.slot("node",this.node),O.slot("lane",this.lane))))},c.decode=function(e){var t="",r="",n=e.head();if(n.value.isRecord)for(var i=n.value.iterator(),o=0;!i.isEmpty();){var s=i.next();if(s.isField)switch(s.key){case"node":t=s.value;break;case"lane":r=s.value}else switch(o){case 0:t=s;break;case 1:r=s}o+=1}return new c(t,r)},h.prototype=Object.create(u.prototype),h.prototype.constructor=h,Object.defineProperty(h.prototype,"isSyncedResponse",{value:!0}),h.prototype.encode=function(){return O(O.attr("synced",O(O.slot("node",this.node),O.slot("lane",this.lane))))},h.decode=function(e){var t="",r="",n=e.head();if(n.value.isRecord)for(var i=n.value.iterator(),o=0;!i.isEmpty();){var s=i.next();if(s.isField)switch(s.key){case"node":t=s.value;break;case"lane":r=s.value}else switch(o){case 0:t=s;break;case 1:r=s}o+=1}return new h(t,r)},y.prototype=Object.create(p.prototype),y.prototype.constructor=y,Object.defineProperty(y.prototype,"isLinkRequest",{value:!0}),y.prototype.encode=function(){return O(O.attr("link",O(O.slot("node",this.node),O.slot("lane",this.lane))))},y.decode=function(e){var t="",r="",n=e.head();if(n.value.isRecord)for(var i=n.value.iterator(),o=0;!i.isEmpty();){var s=i.next();if(s.isField)switch(s.key){case"node":t=s.value;break;case"lane":r=s.value}else switch(o){case 0:t=s;break;case 1:r=s}o+=1}return new y(t,r)},v.prototype=Object.create(u.prototype),v.prototype.constructor=v,Object.defineProperty(v.prototype,"isLinkedResponse",{value:!0}),v.prototype.encode=function(){return O(O.attr("linked",O(O.slot("node",this.node),O.slot("lane",this.lane))))},v.decode=function(e){var t="",r="",n=e.head();if(n.value.isRecord)for(var i=n.value.iterator(),o=0;!i.isEmpty();){var s=i.next();if(s.isField)switch(s.key){case"node":t=s.value;break;case"lane":r=s.value}else switch(o){case 0:t=s;break;case 1:r=s}o+=1}return new v(t,r)},m.prototype=Object.create(p.prototype),m.prototype.constructor=m,Object.defineProperty(m.prototype,"isUnlinkRequest",{value:!0}),m.prototype.encode=function(){return O(O.attr("unlink",O(O.slot("node",this.node),O.slot("lane",this.lane))))},m.decode=function(e){var t="",r="",n=e.head();if(n.value.isRecord)for(var i=n.value.iterator(),o=0;!i.isEmpty();){var s=i.next();if(s.isField)switch(s.key){case"node":t=s.value;break;case"lane":r=s.value}else switch(o){case 0:t=s;break;case 1:r=s}o+=1}return new m(t,r)},b.prototype=Object.create(u.prototype),b.prototype.constructor=b,Object.defineProperty(b.prototype,"isUnlinkedResponse",{value:!0}),b.prototype.encode=function(){return O(O.attr("unlinked",O(O.slot("node",this.node),O.slot("lane",this.lane))))},b.decode=function(e){var t="",r="",n=e.head();if(n.value.isRecord)for(var i=n.value.iterator(),o=0;!i.isEmpty();){var s=i.next();if(s.isField)switch(s.key){case"node":t=s.value;break;case"lane":r=s.value}else switch(o){case 0:t=s;break;case 1:r=s}o+=1}return new b(t,r)},E.prototype=Object.create(p.prototype),E.prototype.constructor=E,Object.defineProperty(E.prototype,"isGetRequest",{value:!0}),E.prototype.encode=function(){return O(O.attr("get",O(O.slot("node",this.node))))},E.decode=function(e){var t="",r=e.head();if(r.value.isRecord)for(var n=r.value.iterator(),i=0;!n.isEmpty();){var o=n.next();if(o.isField)switch(o.key){case"node":t=o.value}else switch(i){case 0:t=o}i+=1}else r.value.isExtant||(t=r.value);return new E(t)},w.prototype=Object.create(p.prototype),w.prototype.constructor=w,Object.defineProperty(w.prototype,"isPutRequest",{value:!0}),w.prototype.encode=function(){var e=O.builder();return e.attr("put",O(O.slot("node",this.node))),e.appendRecord(this.body),e.state()},w.decode=function(e){var t="",r=e.tail(),n=e.head();if(n.value.isRecord)for(var i=n.value.iterator(),o=0;!i.isEmpty();){var s=i.next();if(s.isField)switch(s.key){case"node":t=s.value}else switch(o){case 0:t=s}o+=1}else n.value.isExtant||(t=n.value);return new w(t,r)},g.prototype=Object.create(u.prototype),g.prototype.constructor=g,Object.defineProperty(g.prototype,"isStateResponse",{value:!0}),g.prototype.encode=function(){var e=O.builder();return e.attr("state",O(O.slot("node",this.node))),e.appendRecord(this.body),e.state()},g.decode=function(e){var t="",r=e.tail(),n=e.head();if(n.value.isRecord)for(var i=n.value.iterator(),o=0;!i.isEmpty();){var s=i.next();if(s.isField)switch(s.key){case"node":t=s.value}else switch(o){case 0:t=s}o+=1}else n.value.isExtant||(t=n.value);return new g(t,r)},r.decode=n,r.encode=i,r.parse=o,r.stringify=s,r.Envelope=a,r.RequestEnvelope=p,r.ResponseEnvelope=u,r.MessageEnvelope=l,r.EventMessage=f,r.CommandMessage=d,r.SyncRequest=c,r.SyncedResponse=h,r.LinkRequest=y,r.LinkedResponse=v,r.UnlinkRequest=m,r.UnlinkedResponse=b,r.GetRequest=E,r.PutRequest=w,r.StateResponse=g},{"recon-js":1}],3:[function(e,t,r){var n=function(){function e(e){throw new RangeError(k[e])}function t(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function r(e,r){var n=e.split("@"),i="";n.length>1&&(i=n[0]+"@",e=n[1]),e=e.replace(C,".");var o=e.split("."),s=t(o,r).join(".");return i+s}function n(e){for(var t,r,n=[],i=0,o=e.length;o>i;)t=e.charCodeAt(i++),t>=55296&&56319>=t&&o>i?(r=e.charCodeAt(i++),56320==(64512&r)?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--)):n.push(t);return n}function i(e){return t(e,function(e){var t="";return e>65535&&(e-=65536,t+=R(e>>>10&1023|55296),e=56320|1023&e),t+=R(e)}).join("")}function o(e){return 10>e-48?e-22:26>e-65?e-65:26>e-97?e-97:h}function s(e,t){return e+22+75*(26>e)-((0!=t)<<5)}function a(e,t,r){var n=0;for(e=r?j(e/b):e>>1,e+=j(e/t);e>x*v>>1;n+=h)e=j(e/x);return j(n+(x+1)*e/(e+m))}function p(t){var r,n,s,p,u,l,f,d,m,b,O=[],D=t.length,C=0,k=w,x=E;for(n=t.lastIndexOf(g),0>n&&(n=0),s=0;n>s;++s)t.charCodeAt(s)>=128&&e("not-basic"),O.push(t.charCodeAt(s));for(p=n>0?n+1:0;D>p;){for(u=C,l=1,f=h;p>=D&&e("invalid-input"),d=o(t.charCodeAt(p++)),(d>=h||d>j((c-C)/l))&&e("overflow"),C+=d*l,m=x>=f?y:f>=x+v?v:f-x,!(m>d);f+=h)b=h-m,l>j(c/b)&&e("overflow"),l*=b;r=O.length+1,x=a(C-u,r,0==u),j(C/r)>c-k&&e("overflow"),k+=j(C/r),C%=r,O.splice(C++,0,k)}return i(O)}function u(t){var r,i,o,p,u,l,f,d,m,b,O,D,C,k,x,P=[];for(t=n(t),D=t.length,r=w,i=0,u=E,l=0;D>l;++l)O=t[l],128>O&&P.push(R(O));for(o=p=P.length,p&&P.push(g);D>o;){for(f=c,l=0;D>l;++l)O=t[l],O>=r&&f>O&&(f=O);for(C=o+1,f-r>j((c-i)/C)&&e("overflow"),i+=(f-r)*C,r=f,l=0;D>l;++l)if(O=t[l],r>O&&++i>c&&e("overflow"),O==r){for(d=i,m=h;b=u>=m?y:m>=u+v?v:m-u,!(b>d);m+=h)x=d-b,k=h-b,P.push(R(s(b+x%k,0))),d=j(x/k);P.push(R(s(d,0))),u=a(i,C,o==p),i=0,++o}++i,++r}return P.join("")}function l(e){return r(e,function(e){return O.test(e)?p(e.slice(4).toLowerCase()):e})}function f(e){return r(e,function(e){return D.test(e)?"xn--"+u(e):e})}var d,c=2147483647,h=36,y=1,v=26,m=38,b=700,E=72,w=128,g="-",O=/^xn--/,D=/[^\x20-\x7E]/,C=/[\x2E\u3002\uFF0E\uFF61]/g,k={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},x=h-y,j=Math.floor,R=String.fromCharCode;return d={version:"1.3.2",ucs2:{decode:n,encode:i},decode:p,encode:u,toASCII:f,toUnicode:l}}();"undefined"==typeof COMPILED&&"undefined"!=typeof t&&(t.exports=n)},{}],4:[function(e,t,r){e("./schemes/http"),e("./schemes/urn"),e("./schemes/mailto")},{"./schemes/http":5,"./schemes/mailto":6,"./schemes/urn":7}],5:[function(e,t,r){if("undefined"==typeof COMPILED&&"undefined"==typeof n&&"function"==typeof e)var n=e("../uri");n.SCHEMES.http=n.SCHEMES.https={domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){return(e.port===("https"!==String(e.scheme).toLowerCase()?80:443)||""===e.port)&&(e.port=void 0),e.path||(e.path="/"),e}}},{"../uri":8}],6:[function(e,t,r){if("undefined"==typeof COMPILED&&"undefined"==typeof n&&"function"==typeof e)var n=e("../uri"),i=e("../punycode");!function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];if(e.length>1){e[0]=e[0].slice(0,-1);for(var r=e.length-1,n=1;r>n;++n)e[n]=e[n].slice(1,-1);return e[r]=e[r].slice(1),e.join("")}return e[0]}function t(e){return"(?:"+e+")"}function r(e){return e.toUpperCase()}function o(e){var t=n.pctDecChars(e);return t.match(F)?t:e}function s(e){return void 0!==e&&null!==e?e instanceof Array&&!e.callee?e:"number"!=typeof e.length||e.split||e.setInterval||e.call?[e]:Array.prototype.slice.call(e):[]}var a={},p=n.IRI_SUPPORT,u="[A-Za-z0-9\\-\\.\\_\\~"+(p?"\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF":"")+"]",l="[0-9A-Fa-f]",f=t(t("%[EFef]"+l+"%"+l+l+"%"+l+l)+"|"+t("%[89A-Fa-f]"+l+"%"+l+l)+"|"+t("%"+l+l)),d="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",c="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",h=e(c,'[\\"\\\\]'),y=t(d+"+"+t("\\."+d+"+")+"*"),v=t("\\\\"+h),m=t(c+"|"+v),b=t('\\"'+m+'*\\"'),E="[\\x21-\\x5A\\x5E-\\x7E]",w="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",g=t(u+"|"+f+"|"+w),O=t(y+"|\\["+E+"*\\]"),D=t(y+"|"+b),C=t(D+"\\@"+O),k=t(C+t("\\,"+C)+"*"),x=t(g+"*"),j=x,R=t(x+"\\="+j),P=t(R+t("\\&"+R)+"*"),S=t("\\?"+P),F=(n.VALIDATE_SUPPORT&&new RegExp("^mailto\\:"+k+"?"+S+"?$"),new RegExp(u,"g")),A=new RegExp(f,"g"),_=new RegExp(e("[^]",d,"[\\.]",'[\\"]',h),"g"),T=new RegExp(e("[^]",d,"[\\.]","[\\[]",E,"[\\]]"),"g"),I=new RegExp(e("[^]",u,w),"g"),q=I,N=n.VALIDATE_SUPPORT&&new RegExp("^"+k+"$"),U=n.VALIDATE_SUPPORT&&new RegExp("^"+P+"$");n.SCHEMES.mailto={parse:function(e,t){n.VALIDATE_SUPPORT&&!e.error&&(e.path&&!N.test(e.path)?e.error="Email address is not valid":e.query&&!U.test(e.query)&&(e.error="Header fields are invalid"));var r=e.to=e.path?e.path.split(","):[];if(e.path=void 0,e.query){for(var o=!1,s={},a=e.query.split("&"),p=0,u=a.length;u>p;++p){var l=a[p].split("=");switch(l[0]){case"to":for(var f=l[1].split(","),d=0,c=f.length;c>d;++d)r.push(f[d]);break;case"subject":e.subject=n.unescapeComponent(l[1],t);break;case"body":e.body=n.unescapeComponent(l[1],t);break;default:o=!0,s[n.unescapeComponent(l[0],t)]=n.unescapeComponent(l[1],t)}}o&&(e.headers=s)}e.query=void 0;for(var p=0,u=r.length;u>p;++p){var h=r[p].split("@");if(h[0]=n.unescapeComponent(h[0]),"undefined"==typeof i||t.unicodeSupport)h[1]=n.unescapeComponent(h[1],t).toLowerCase();else try{h[1]=i.toASCII(n.unescapeComponent(h[1],t).toLowerCase())}catch(y){e.error=e.error||"Email address's domain name can not be converted to ASCII via punycode: "+y}r[p]=h.join("@")}return e},serialize:function(e,t){var p=s(e.to);if(p){for(var u=0,l=p.length;l>u;++u){var f=String(p[u]),d=f.lastIndexOf("@"),c=f.slice(0,d),h=f.slice(d+1);if(c=c.replace(A,o).replace(A,r).replace(_,n.pctEncChar),"undefined"!=typeof i)try{h=t.iri?i.toUnicode(h):i.toASCII(n.unescapeComponent(h,t).toLowerCase())}catch(y){e.error=e.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+y}else h=h.replace(A,o).toLowerCase().replace(A,r).replace(T,n.pctEncChar);p[u]=c+"@"+h}e.path=p.join(",")}var v=e.headers=e.headers||{};e.subject&&(v.subject=e.subject),e.body&&(v.body=e.body);var m=[];for(var b in v)v[b]!==a[b]&&m.push(b.replace(A,o).replace(A,r).replace(I,n.pctEncChar)+"="+v[b].replace(A,o).replace(A,r).replace(q,n.pctEncChar));return m.length&&(e.query=m.join("&")),e}}}()},{"../punycode":3,"../uri":8}],7:[function(e,t,r){if("undefined"==typeof COMPILED&&"undefined"==typeof n&&"function"==typeof e)var n=e("../uri");!function(){var e=n.pctEncChar,t="(?:[0-9A-Za-z][0-9A-Za-z\\-]{1,31})",r="(?:\\%[0-9A-Fa-f]{2})",i="[0-9A-Za-z\\(\\)\\+\\,\\-\\.\\:\\=\\@\\;\\$\\_\\!\\*\\'\\/\\?\\#]",o="(?:(?:"+r+"|"+i+")+)",s=new RegExp("^urn\\:("+t+")$"),a=new RegExp("^("+t+")\\:("+o+")$"),p=/^([^\:]+)\:(.*)/,u=/[\x00-\x20\\\"\&\<\>\[\]\^\`\{\|\}\~\x7F-\xFF]/g,l=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/;n.SCHEMES.urn={parse:function(e,t){var r,i,o=e.path.match(a);return o||(t.tolerant||(e.error=e.error||"URN is not strictly valid."),o=e.path.match(p)),o?(r="urn:"+o[1].toLowerCase(),i=n.SCHEMES[r],i||(i=n.SCHEMES[r]={parse:function(e,t){return e},serialize:n.SCHEMES.urn.serialize}),e.scheme=r,e.path=o[2],e=i.parse(e,t)):e.error=e.error||"URN can not be parsed.",e},serialize:function(t,r){var n,i=t.scheme||r.scheme;if(i&&"urn"!==i){var n=i.match(s);n||(n=["urn:"+i,i]),t.scheme="urn",t.path=n[1]+":"+(t.path?t.path.replace(u,e):"")}return t}},n.SCHEMES["urn:uuid"]={parse:function(e,t){return t.tolerant||e.path&&e.path.match(l)||(e.error=e.error||"UUID is not valid."),e},serialize:function(e,t){return t.tolerant||e.path&&e.path.match(l)?e.path=(e.path||"").toLowerCase():e.scheme=void 0,n.SCHEMES.urn.serialize(e,t)}}}()},{"../uri":8}],8:[function(e,t,r){var n=!1,i=!0,o=!0,s=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];if(e.length>1){e[0]=e[0].slice(0,-1);for(var r=e.length-1,n=1;r>n;++n)e[n]=e[n].slice(1,-1);return e[r]=e[r].slice(1),e.join("")}return e[0]}function t(e){return"(?:"+e+")"}function r(r){{var n="[A-Za-z]",i="[0-9]",s=e(i,"[A-Fa-f]"),a=t(t("%[EFef]"+s+"%"+s+s+"%"+s+s)+"|"+t("%[89A-Fa-f]"+s+"%"+s+s)+"|"+t("%"+s+s)),p="[\\:\\/\\?\\#\\[\\]\\@]",u="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",l=e(p,u),f=r?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",d=r?"[\\uE000-\\uF8FF]":"[]",c=e(n,i,"[\\-\\.\\_\\~]",f),h=t(n+e(n,i,"[\\+\\-\\.]")+"*"),y=t(t(a+"|"+e(c,u,"[\\:]"))+"*"),v=t(t("25[0-5]")+"|"+t("2[0-4]"+i)+"|"+t("1"+i+i)+"|"+t("[1-9]"+i)+"|"+i),m=t(v+"\\."+v+"\\."+v+"\\."+v),b=t(s+"{1,4}"),E=(t(t(b+"\\:"+b)+"|"+m),t(e(c,u,"[\\:]")+"+")),w=t("v"+s+"+\\."+e(c,u,"[\\:]")+"+"),g=t("\\["+t(E+"|"+w)+"\\]"),O=t(t(a+"|"+e(c,u))+"*"),D=t(g+"|"+m+"(?!"+O+")|"+O),C=t(i+"*"),k=t(t(y+"@")+"?"+D+t("\\:"+C)+"?"),x=t(a+"|"+e(c,u,"[\\:\\@]")),j=t(x+"*"),R=t(x+"+"),P=t(t(a+"|"+e(c,u,"[\\@]"))+"+"),S=t(t("\\/"+j)+"*"),F=t("\\/"+t(R+S)+"?"),A=t(P+S),_=t(R+S),T="(?!"+x+")",I=(t(S+"|"+F+"|"+A+"|"+_+"|"+T),t(t(x+"|"+e("[\\/\\?]",d))+"*")),q=t(t(x+"|[\\/\\?]")+"*"),N=t(t("\\/\\/"+k+S)+"|"+F+"|"+_+"|"+T),U=t(h+"\\:"+N+t("\\?"+I)+"?"+t("\\#"+q)+"?"),M=t(t("\\/\\/"+k+S)+"|"+F+"|"+A+"|"+T),H=t(M+t("\\?"+I)+"?"+t("\\#"+q)+"?"),L=(t(U+"|"+H),t(h+"\\:"+N+t("\\?"+I)+"?"),"^("+h+")\\:"+t(t("\\/\\/("+t("("+y+")@")+"?("+D+")"+t("\\:("+C+")")+"?)")+"?("+S+"|"+F+"|"+_+"|"+T+")")+t("\\?("+I+")")+"?"+t("\\#("+q+")")+"?$"),B="^(){0}"+t(t("\\/\\/("+t("("+y+")@")+"?("+D+")"+t("\\:("+C+")")+"?)")+"?("+S+"|"+F+"|"+A+"|"+T+")")+t("\\?("+I+")")+"?"+t("\\#("+q+")")+"?$";"^("+h+")\\:"+t(t("\\/\\/("+t("("+y+")@")+"?("+D+")"+t("\\:("+C+")")+"?)")+"?("+S+"|"+F+"|"+_+"|"+T+")")+t("\\?("+I+")")+"?$","^"+t("\\#("+q+")")+"?$","^"+t("("+y+")@")+"?("+D+")"+t("\\:("+C+")")+"?$"}return{URI_REF:o&&new RegExp("("+L+")|("+B+")"),NOT_SCHEME:new RegExp(e("[^]",n,i,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(e("[^\\%\\:]",c,u),"g"),NOT_HOST:new RegExp(e("[^\\%]",c,u),"g"),NOT_PATH:new RegExp(e("[^\\%\\/\\:\\@]",c,u),"g"),NOT_PATH_NOSCHEME:new RegExp(e("[^\\%\\/\\@]",c,u),"g"),NOT_QUERY:new RegExp(e("[^\\%]",c,u,"[\\:\\@\\/\\?]",d),"g"),NOT_FRAGMENT:new RegExp(e("[^\\%]",c,u,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(e("[^]",c,u),"g"),UNRESERVED:new RegExp(c,"g"),OTHER_CHARS:new RegExp(e("[^\\%]",c,l),"g"),PCT_ENCODED:new RegExp(a,"g")}}function n(e){var t,r=e.charCodeAt(0);return t=16>r?"%0"+r.toString(16).toUpperCase():128>r?"%"+r.toString(16).toUpperCase():2048>r?"%"+(r>>6|192).toString(16).toUpperCase()+"%"+(63&r|128).toString(16).toUpperCase():"%"+(r>>12|224).toString(16).toUpperCase()+"%"+(r>>6&63|128).toString(16).toUpperCase()+"%"+(63&r|128).toString(16).toUpperCase()}function s(e){for(var t,r,n,i="",o=0,s=e.length;s>o;)t=parseInt(e.substr(o+1,2),16),128>t?(i+=String.fromCharCode(t),o+=3):t>=194&&224>t?(s-o>=6?(r=parseInt(e.substr(o+4,2),16),i+=String.fromCharCode((31&t)<<6|63&r)):i+=e.substr(o,6),o+=6):t>=224?(s-o>=9?(r=parseInt(e.substr(o+4,2),16),n=parseInt(e.substr(o+7,2),16),i+=String.fromCharCode((15&t)<<12|(63&r)<<6|63&n)):i+=e.substr(o,9),o+=9):(i+=e.substr(o,3),o+=3);return i}function p(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function u(e){return e.toUpperCase()}function l(e,t){function r(e){var r=s(e);return r.match(t.UNRESERVED)?r:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,r).replace(t.NOT_USERINFO,n).replace(t.PCT_ENCODED,u)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_HOST,n).replace(t.PCT_ENCODED,u)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,r).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,n).replace(t.PCT_ENCODED,u)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,r).replace(t.NOT_QUERY,n).replace(t.PCT_ENCODED,u)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,r).replace(t.NOT_FRAGMENT,n).replace(t.PCT_ENCODED,u)),e}function f(e,t){void 0===t&&(t={});var r,n,p=i&&t.iri!==!1?O:g,u=!1,f={};if("suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e),o?(r=e.match(p.URI_REF),r&&(r=r[1]?r.slice(1,10):r.slice(10,19)),r||(u=!0,t.tolerant||(f.error=f.error||"URI is not strictly valid."),r=e.match(D))):r=e.match(D),r){if(R?(f.scheme=r[1],f.userinfo=r[3],f.host=r[4],f.port=parseInt(r[5],10),f.path=r[6]||"",f.query=r[7],f.fragment=r[8],isNaN(f.port)&&(f.port=r[5])):(f.scheme=r[1]||void 0,f.userinfo=-1!==e.indexOf("@")?r[3]:void 0,f.host=-1!==e.indexOf("//")?r[4]:void 0,f.port=parseInt(r[5],10),f.path=r[6]||"",f.query=-1!==e.indexOf("?")?r[7]:void 0,f.fragment=-1!==e.indexOf("#")?r[8]:void 0,isNaN(f.port)&&(f.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?r[4]:void 0)),f.reference=void 0!==f.scheme||void 0!==f.userinfo||void 0!==f.host||void 0!==f.port||f.path||void 0!==f.query?void 0===f.scheme?"relative":void 0===f.fragment?"absolute":"uri":"same-document",t.reference&&"suffix"!==t.reference&&t.reference!==f.reference&&(f.error=f.error||"URI is not a "+t.reference+" reference."),n=P[(t.scheme||f.scheme||"").toLowerCase()],!i||"undefined"==typeof a||t.unicodeSupport||n&&n.unicodeSupport)l(f,p);else{if(f.host&&(t.domainHost||n&&n.domainHost))try{f.host=a.toASCII(f.host.replace(p.PCT_ENCODED,s).toLowerCase())}catch(d){f.error=f.error||"Host's domain name can not be converted to ASCII via punycode: "+d}l(f,g)}n&&n.parse&&n.parse(f,t)}else u=!0,f.error=f.error||"URI can not be parsed.";return f}function d(e,t){var r=[];return void 0!==e.userinfo&&(r.push(e.userinfo),r.push("@")),void 0!==e.host&&r.push(e.host),"number"==typeof e.port&&(r.push(":"),r.push(e.port.toString(10))),r.length?r.join(""):void 0}function c(e){for(var t,r=[];e.length;)e.match(C)?e=e.replace(C,""):e.match(k)?e=e.replace(k,"/"):e.match(x)?(e=e.replace(x,"/"),r.pop()):"."===e||".."===e?e="":(t=e.match(j)[0],e=e.slice(t.length),r.push(t));return r.join("")}function h(e,t){void 0===t&&(t={});var r,n,o,p=i&&t.iri?O:g,u=[];if(r=P[(t.scheme||e.scheme||"").toLowerCase()],r&&r.serialize&&r.serialize(e,t),i&&"undefined"!=typeof a&&e.host&&(t.domainHost||r&&r.domainHost))try{e.host=t.iri?a.toUnicode(e.host):a.toASCII(e.host.replace(p.PCT_ENCODED,s).toLowerCase())}catch(f){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+f}return l(e,p),"suffix"!==t.reference&&e.scheme&&(u.push(e.scheme),u.push(":")),n=d(e,t),void 0!==n&&("suffix"!==t.reference&&u.push("//"),u.push(n),e.path&&"/"!==e.path.charAt(0)&&u.push("/")),void 0!==e.path&&(o=e.path,t.absolutePath||r&&r.absolutePath||(o=c(o)),void 0===n&&(o=o.replace(/^\/\//,"/%2F")),u.push(o)),void 0!==e.query&&(u.push("?"),u.push(e.query)),void 0!==e.fragment&&(u.push("#"),u.push(e.fragment)),u.join("")}function y(e,t,r,n){void 0===r&&(r={});var i={};return n||(e=f(h(e,r),r),t=f(h(t,r),r)),r=r||{},!r.tolerant&&t.scheme?(i.scheme=t.scheme,i.userinfo=t.userinfo,i.host=t.host,i.port=t.port,i.path=c(t.path),i.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(i.userinfo=t.userinfo,i.host=t.host,i.port=t.port,i.path=c(t.path),i.query=t.query):(t.path?("/"===t.path.charAt(0)?i.path=c(t.path):(i.path=void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:t.path:"/"+t.path,i.path=c(i.path)),i.query=t.query):(i.path=e.path,i.query=void 0!==t.query?t.query:e.query),i.userinfo=e.userinfo,i.host=e.host,i.port=e.port),i.scheme=e.scheme),i.fragment=t.fragment,i}function v(e,t,r){return h(y(f(e,r),f(t,r),r,!0),r)}function m(e,t){return"string"==typeof e?e=h(f(e,t),t):"object"===p(e)&&(e=f(h(e,t),t)),e}function b(e,t,r){return"string"==typeof e?e=h(f(e,r),r):"object"===p(e)&&(e=h(e,r)),"string"==typeof t?t=h(f(t,r),r):"object"===p(t)&&(t=h(t,r)),e===t}function E(e,t){return e&&e.toString().replace(i&&t&&t.iri?O.ESCAPE:g.ESCAPE,n)}function w(e,t){return e&&e.toString().replace(i&&t&&t.iri?O.PCT_ENCODED:g.PCT_ENCODED,s)}var g=r(!1),O=i?r(!0):void 0,D=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?([^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n)*))?/i,C=/^\.\.?\//,k=/^\/\.(\/|$)/,x=/^\/\.\.(\/|$)/,j=/^\/?(?:.|\n)*?(?=\/|$)/,R=void 0==="".match(/(){0}/)[1],P={};return{IRI_SUPPORT:i,VALIDATE_SUPPORT:o,pctEncChar:n,pctDecChars:s,SCHEMES:P,parse:f,_recomposeAuthority:d,removeDotSegments:c,serialize:h,resolveComponents:y,resolve:v,normalize:m,equal:b,escapeComponent:E,unescapeComponent:w}}();if(!n&&"undefined"!=typeof t&&"function"==typeof e){var a=e("./punycode");t.exports=s,e("./schemes")}},{"./punycode":3,"./schemes":4}],9:[function(e,t,r){function n(e,t){var r;return r=t?new o(e,t):new o(e)}var i=function(){return this}(),o=i.WebSocket||i.MozWebSocket;t.exports={w3cwebsocket:o?n:null,version:e("./version")}},{"./version":10}],10:[function(e,t,r){t.exports=e("../package.json").version},{"../package.json":11}],11:[function(e,t,r){t.exports={name:"websocket",description:"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",keywords:["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],author:{name:"Brian McKelvey",email:"brian@worlize.com",url:"https://www.worlize.com/"},contributors:[{name:"Iñaki Baz Castillo",email:"ibc@aliax.net",url:"http://dev.sipdoc.net"}],version:"1.0.21",repository:{type:"git",url:"git+https://github.com/theturtle32/WebSocket-Node.git"},homepage:"https://github.com/theturtle32/WebSocket-Node",engines:{node:">=0.8.0"},dependencies:{debug:"~2.2.0",nan:"~1.8.x","typedarray-to-buffer":"~3.0.3",yaeti:"~0.0.4"},devDependencies:{"buffer-equal":"^0.0.1",faucet:"^0.0.1",gulp:"git+https://github.com/gulpjs/gulp.git#4.0","gulp-jshint":"^1.11.2","jshint-stylish":"^1.0.2",tape:"^4.0.1"},config:{verbose:!1},scripts:{install:"(node-gyp rebuild 2> builderror.log) || (exit 0)",test:"faucet test/unit",gulp:"gulp"},main:"index",directories:{lib:"./lib"},browser:"lib/browser.js",license:"Apache-2.0",gitHead:"8f5d5f3ef3d946324fe016d525893546ff6500e1",bugs:{url:"https://github.com/theturtle32/WebSocket-Node/issues"},_id:"websocket@1.0.21",_shasum:"f51f0a96ed19629af39922470ab591907f1c5bd9",_from:"websocket@>=1.0.21 <2.0.0",_npmVersion:"2.12.1",_nodeVersion:"2.3.4",_npmUser:{name:"theturtle32",email:"brian@worlize.com"},maintainers:[{name:"theturtle32",email:"brian@worlize.com"}],dist:{shasum:"f51f0a96ed19629af39922470ab591907f1c5bd9",tarball:"https://repo.webaware.com/sinopia/websocket/-/websocket-1.0.21.tgz"},_resolved:"https://repo.webaware.com/sinopia/websocket/-/websocket-1.0.21.tgz",readme:"ERROR: No README data found!"}},{}],12:[function(e,t,r){"use strict";function n(){}function i(e,t,r){f.get(e).link(e,t,r)}function o(e,t,r){f.get(e).unlink(e,t,r)}function s(e,t,r){f.get(e).sendEvent(e,t,r)}function a(e,t,r){f.get(e).sendCommand(e,t,r)}function p(e,t){f.get(e).get(e,t)}function u(e,t,r){f.get(e).put(e,t,r)}function l(){for(var e in f.bridge){var t=f.bridge[e];t.sendBuffer=[],t.unlinkAll(),t.close()}f.bridge={}}function f(e){f.bridge[e]=this,this.node=e,this.linkCount=0,this.linkHandles={},this.stateHandles={},this.sendBuffer=[],this.reconnectTimeout=null,this.reconnectTime=250+Math.round(750*Math.random()),this.closed=!1,this.open()}var d=e("swim-proto-js"),c=e("uri-js"),h=e("websocket").w3cwebsocket,y={SEND_BUFFER_SIZE:1024,MAX_RECONNECT_TIME:15e3},v=-2,m=-1,b=0,E=1;f.prototype.open=function(){this.socket=new h(this.node,"swim-0.0"),this.socket.onopen=this.onOpen.bind(this),this.socket.onclose=this.onClose.bind(this),this.socket.onmessage=this.onFrame.bind(this),this.socket.onerror=this.onError.bind(this)},f.prototype.close=function(){this.closed=!0,this.socket.close()},f.prototype.send=function(e){this.socket.readyState!==this.socket.OPEN?this.buffer(e):this.socket.send(d.stringify(e))},f.prototype.buffer=function(e){e.isLinkRequest||e.isUnlinkRequest||this.sendBuffer.length>y.SEND_BUFFER_SIZE||this.sendBuffer.push(e)},f.prototype.onOpen=function(){clearTimeout(this.reconnectTimeout),this.reconnectTime=250+Math.round(750*Math.random());var e;for(var t in this.linkHandles){var r=this.linkHandles[t];for(var n in r)e=new d.LinkRequest(this.unresolve(t),n),this.send(e)}for(;e=this.sendBuffer.shift();)this.send(e)},f.prototype.onClose=function(){if(0===this.linkCount&&0===this.sendBuffer.length)return void delete f.bridge[this.node];for(var e in this.linkHandles){var t=this.linkHandles[e];for(var r in t)for(var n=t[r],i=0,o=n.length;o>i;i+=1){var s=n[i],a=s.__state__;a.status===E&&(s.onBroken(e,r),a.status=m)}}this.closed||(this.reconnectTimeout=setTimeout(this.open.bind(this),this.reconnectTime),this.reconnectTime=Math.min(2*this.reconnectTime,y.MAX_RECONNECT_TIME))},f.prototype.onError=function(){try{this.socket.close()}catch(e){}},f.prototype.onFrame=function(e){var t=e.data;if("string"==typeof t){var r=d.parse(t);r&&this.onReceive(r)}},f.prototype.link=function(e,t,r){"function"==typeof r&&(r={onEvent:r,onCommand:r}),r.onEvent||(r.onEvent=n),r.onCommand||(r.onCommand=n),r.onLinked||(r.onLinked=n),r.onUnlinked||(r.onUnlinked=n),r.onBroken||(r.onBroken=n),r.onUnbroken||(r.onUnbroken=n),r.onFailed||(r.onFailed=n);var i={status:b};r.__state__=i;var o=!1,s=this.linkHandles[e];void 0===s&&(s={},this.linkHandles[e]=s);var a=s[t];if(void 0===a&&(o=!0,a=[],s[t]=a),a.push(r),o){var p=new d.LinkRequest(this.unresolve(e),t);this.send(p),this.linkCount+=1}else this.socket.readyState===this.socket.OPEN&&(r.onLinked(e,t),i.status=E)},f.prototype.unlink=function(e,t,r){var n=this.linkHandles[e];if(void 0!==n){var i=n[t];if(void 0!==i){var o=-1;if(r instanceof Function){for(var s=0,a=i.length;a>s;s+=1)if(i[s].onEvent===r){o=s;break}}else o=i.indexOf(r);if(!(0>o)&&(i.splice(o,1),0===i.length)){delete n[t],0===Object.keys(n).length&&delete this.linkHandles[e];var p=new d.UnlinkRequest(this.unresolve(e),t);this.send(p),this.linkCount-=1}}}},f.prototype.unlinkAll=function(){for(var e in this.linkHandles){var t=this.linkHandles[e];for(var r in t)for(var n=t[r],i=0,o=n.length;o>i;i+=1){var s=n[i],a=s.__state__;s.onFailed(e,r),a.status=v}}this.linkCount=0,this.linkHandles={}},f.prototype.sendEvent=function(e,t,r){var n=new d.EventMessage(this.unresolve(e),t,void 0,r);this.send(n)},f.prototype.sendCommand=function(e,t,r){var n=new d.CommandMessage(this.unresolve(e),t,void 0,r);this.send(n)},f.prototype.get=function(e,t){"function"==typeof t&&(t={onState:t});var r=this.stateHandles[e];void 0===r&&(r=[],this.stateHandles[e]=r),r.push(t);var n=new d.GetRequest(this.unresolve(e));this.send(n)},f.prototype.put=function(e,t,r){void 0===r&&(r=n),"function"==typeof r&&(r={onState:r});var i=this.stateHandles[e];void 0===i&&(i=[],
this.stateHandles[e]=i),i.push(r);var o=new d.PutRequest(this.unresolve(e),t);this.send(o)},f.prototype.onReceive=function(e){e.isEventMessage?this.onMessage(e):e.isCommandMessage?this.onMessage(e):e.isStateResponse?this.onState(e):e.isLinkedResponse?this.onLinked(e):e.isUnlinkedResponse&&this.onUnlinked(e)},f.prototype.onMessage=function(e){var t=c.resolve(this.node,e.node),r=this.linkHandles[t];if(void 0!==r)for(var n=e.lane;n;){var i=r[n];if(i)for(var o=0,s=i.length;s>o;o+=1){var a=i[o];e.isEventMessage?a.onEvent(e):a.onCommand(e)}n=f.parentLane(n)}},f.prototype.onState=function(e){for(var t,r=c.resolve(this.node,e.node),n=this.stateHandles[r]||[];t=n.shift();)t.onState(e);delete this.stateHandles[r]},f.prototype.onLinked=function(e){var t=c.resolve(this.node,e.node),r=e.lane,n=this.linkHandles[t];if(void 0!==n){var i=n[r];if(void 0!==i)for(var o=0,s=i.length;s>o;o+=1){var a=i[o],p=a.__state__;p.status===m?a.onUnbroken(t,r):a.onLinked(t,r),p.status=E}}},f.prototype.onUnlinked=function(e){var t=c.resolve(this.node,e.node),r=e.lane,n=this.linkHandles[t];if(void 0!==n){var i=n[r];if(void 0!==i){for(var o=0,s=i.length;s>o;o+=1){var a=i[o],p=a.__state__;p.status===E?(a.onUnlinked(t,r),p.status=b):(a.onFailed(t,r),p.status=v)}delete n[r],0===Object.keys(n).length&&delete this.linkHandles[t],this.linkCount-=1}}},f.prototype.unresolve=function(e){var t=c.parse(e);return c.serialize({path:t.path,query:t.query,fragment:t.fragment})},f.bridge={},f.get=function(e){var t=f.endpoint(e),r=f.bridge[t];return void 0===r&&(r=new f(t)),r},f.endpoint=function(e){var t=c.parse(e),r=t.scheme;return"swim"===r?r="http":"swims"===r&&(r="https"),c.serialize({scheme:r,userinfo:t.userinfo,host:t.host,port:t.port})},f.parentLane=function(e){var t=c.parse(e),r=t.path;if(t.query&&t.fragment)return c.serialize({path:r,query:t.query});if(t.query)return c.serialize({path:r});if(r.length>0){if(47===r.charCodeAt(r.length-1))return r=r.substring(0,r.length-1),c.serialize({path:r});var n=r.lastIndexOf("/");if(n>0)return r=r.substring(0,n+1),c.serialize({path:r})}},r.link=i,r.unlink=o,r.sendEvent=s,r.sendCommand=a,r.get=p,r.put=u,r.reset=l,r.options=y},{"swim-proto-js":2,"uri-js":8,websocket:9}]},{},[12])(12)});
//# sourceMappingURL=swim-client.min.js.map