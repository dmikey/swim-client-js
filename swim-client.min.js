!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(t.swim||(t.swim={})).client=e()}}(function(){return function e(t,n,o){function i(s,c){if(!n[s]){if(!t[s]){var a="function"==typeof require&&require;if(!c&&a)return a(s,!0);if(r)return r(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[s]={exports:{}};t[s][0].call(u.exports,function(e){var n=t[s][1][e];return i(n?n:e)},u,u.exports,e,t,n,o)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<o.length;s++)i(o[s]);return i}({1:[function(e,t,n){t.exports={version:"0.4.0"}},{}],2:[function(e,t,n){},{}],3:[function(e,t,n){t.exports={version:"0.4.0"}},{}],4:[function(e,t,n){"use strict";function o(e){switch(m.tag(e)){case"@event":return h.decode(e);case"@command":return p.decode(e);case"@link":return d.decode(e);case"@linked":return f.decode(e);case"@sync":return y.decode(e);case"@synced":return v.decode(e);case"@unlink":return g.decode(e);case"@unlinked":return b.decode(e)}}function i(e){return e.encode()}function r(e){return o(m.parse(e))}function s(e){return m.stringify(i(e))}function c(){}function a(){c.call(this)}function l(){c.call(this)}function u(){c.call(this)}function h(e,t,n){u.call(this),this.node=e,this.lane=t,this.body=n}function p(e,t,n){u.call(this),this.node=e,this.lane=t,this.body=n}function d(e,t,n,o){a.call(this),this.node=e,this.lane=t,this.prio=n||0,this.body=o}function f(e,t,n,o){l.call(this),this.node=e,this.lane=t,this.prio=n||0,this.body=o}function y(e,t,n,o){a.call(this),this.node=e,this.lane=t,this.prio=n||0,this.body=o}function v(e,t,n){l.call(this),this.node=e,this.lane=t,this.body=n}function g(e,t,n){a.call(this),this.node=e,this.lane=t,this.body=n}function b(e,t,n){l.call(this),this.node=e,this.lane=t,this.body=n}var k=e("./config.json"),m=e("recon-js");Object.defineProperty(c.prototype,"isRequest",{value:!1}),Object.defineProperty(c.prototype,"isResponse",{value:!1}),Object.defineProperty(c.prototype,"isMessage",{value:!1}),Object.defineProperty(c.prototype,"isEventMessage",{value:!1}),Object.defineProperty(c.prototype,"isCommandMessage",{value:!1}),Object.defineProperty(c.prototype,"isLinkRequest",{value:!1}),Object.defineProperty(c.prototype,"isLinkedResponse",{value:!1}),Object.defineProperty(c.prototype,"isSyncRequest",{value:!1}),Object.defineProperty(c.prototype,"isSyncedResponse",{value:!1}),Object.defineProperty(c.prototype,"isUnlinkRequest",{value:!1}),Object.defineProperty(c.prototype,"isUnlinkedResponse",{value:!1}),a.prototype=Object.create(c.prototype),a.prototype.constructor=a,Object.defineProperty(a.prototype,"isRequest",{value:!0}),l.prototype=Object.create(c.prototype),l.prototype.constructor=l,Object.defineProperty(a.prototype,"isResponse",{value:!0}),u.prototype=Object.create(c.prototype),u.prototype.constructor=u,Object.defineProperty(a.prototype,"isMessage",{value:!0}),h.prototype=Object.create(u.prototype),h.prototype.constructor=h,Object.defineProperty(h.prototype,"isEventMessage",{value:!0}),h.prototype.withAddress=function(e,t){return void 0===e&&(e=this.node),void 0===t&&(t=this.lane),new h(e,t,this.body)},h.prototype.encode=function(){var e=[{node:this.node},{lane:this.lane}];return m.concat({"@event":e},this.body)},h.decode=function(e){for(var t,n,o=m.tail(e),i=m.head(e),r=i&&i.length||0,s=0;r>s;s+=1){var c=i[s];void 0!==c.node?t=c.node:void 0!==c.lane?n=c.lane:0===s?t=c:1===s&&(n=c)}return void 0!==t&&void 0!==n?new h(t,n,o):void 0},p.prototype=Object.create(u.prototype),p.prototype.constructor=p,Object.defineProperty(p.prototype,"isCommandMessage",{value:!0}),p.prototype.withAddress=function(e,t){return void 0===e&&(e=this.node),void 0===t&&(t=this.lane),new p(e,t,this.body)},p.prototype.encode=function(){var e=[{node:this.node},{lane:this.lane}];return m.concat({"@command":e},this.body)},p.decode=function(e){for(var t,n,o=m.tail(e),i=m.head(e),r=i&&i.length||0,s=0;r>s;s+=1){var c=i[s];void 0!==c.node?t=c.node:void 0!==c.lane?n=c.lane:0===s?t=c:1===s&&(n=c)}return void 0!==t&&void 0!==n?new p(t,n,o):void 0},d.prototype=Object.create(a.prototype),d.prototype.constructor=d,Object.defineProperty(d.prototype,"isLinkRequest",{value:!0}),d.prototype.withAddress=function(e,t){return void 0===e&&(e=this.node),void 0===t&&(t=this.lane),new d(e,t,this.prio,this.body)},d.prototype.encode=function(){var e=[{node:this.node},{lane:this.lane}];return this.prio&&e.push({prio:this.prio}),m.concat({"@link":e},this.body)},d.decode=function(e){for(var t,n,o,i=m.tail(e),r=m.head(e),s=r&&r.length||0,c=0;s>c;c+=1){var a=r[c];void 0!==a.node?t=a.node:void 0!==a.lane?n=a.lane:void 0!==a.prio?o=a.prio:0===c?t=a:1===c&&(n=a)}return void 0!==t&&void 0!==n?new d(t,n,o,i):void 0},f.prototype=Object.create(l.prototype),f.prototype.constructor=f,Object.defineProperty(f.prototype,"isLinkedResponse",{value:!0}),f.prototype.withAddress=function(e,t){return void 0===e&&(e=this.node),void 0===t&&(t=this.lane),new f(e,t,this.prio,this.body)},f.prototype.encode=function(){var e=[{node:this.node},{lane:this.lane}];return this.prio&&e.push({prio:this.prio}),m.concat({"@linked":e},this.body)},f.decode=function(e){for(var t,n,o,i=m.tail(e),r=m.head(e),s=r&&r.length||0,c=0;s>c;c+=1){var a=r[c];void 0!==a.node?t=a.node:void 0!==a.lane?n=a.lane:void 0!==a.prio?o=a.prio:0===c?t=a:1===c&&(n=a)}return void 0!==t&&void 0!==n?new f(t,n,o,i):void 0},y.prototype=Object.create(a.prototype),y.prototype.constructor=y,Object.defineProperty(y.prototype,"isSyncRequest",{value:!0}),y.prototype.withAddress=function(e,t){return void 0===e&&(e=this.node),void 0===t&&(t=this.lane),new y(e,t,this.prio,this.body)},y.prototype.encode=function(){var e=[{node:this.node},{lane:this.lane}];return this.prio&&e.push({prio:this.prio}),m.concat({"@sync":e},this.body)},y.decode=function(e){for(var t,n,o,i=m.tail(e),r=m.head(e),s=r&&r.length||0,c=0;s>c;c+=1){var a=r[c];void 0!==a.node?t=a.node:void 0!==a.lane?n=a.lane:void 0!==a.prio?o=a.prio:0===c?t=a:1===c&&(n=a)}return void 0!==t&&void 0!==n?new y(t,n,o,i):void 0},v.prototype=Object.create(l.prototype),v.prototype.constructor=v,Object.defineProperty(v.prototype,"isSyncedResponse",{value:!0}),v.prototype.withAddress=function(e,t){return void 0===e&&(e=this.node),void 0===t&&(t=this.lane),new v(e,t,this.body)},v.prototype.encode=function(){var e=[{node:this.node},{lane:this.lane}];return m.concat({"@synced":e},this.body)},v.decode=function(e){for(var t,n,o=m.tail(e),i=m.head(e),r=i&&i.length||0,s=0;r>s;s+=1){var c=i[s];void 0!==c.node?t=c.node:void 0!==c.lane?n=c.lane:0===s?t=c:1===s&&(n=c)}return void 0!==t&&void 0!==n?new v(t,n,o):void 0},g.prototype=Object.create(a.prototype),g.prototype.constructor=g,Object.defineProperty(g.prototype,"isUnlinkRequest",{value:!0}),g.prototype.withAddress=function(e,t){return void 0===e&&(e=this.node),void 0===t&&(t=this.lane),new g(e,t,this.body)},g.prototype.encode=function(){var e=[{node:this.node},{lane:this.lane}];return m.concat({"@unlink":e},this.body)},g.decode=function(e){for(var t,n,o=m.tail(e),i=m.head(e),r=i&&i.length||0,s=0;r>s;s+=1){var c=i[s];void 0!==c.node?t=c.node:void 0!==c.lane?n=c.lane:0===s?t=c:1===s&&(n=c)}return void 0!==t&&void 0!==n?new g(t,n,o):void 0},b.prototype=Object.create(l.prototype),b.prototype.constructor=b,Object.defineProperty(b.prototype,"isUnlinkedResponse",{value:!0}),b.prototype.withAddress=function(e,t){return void 0===e&&(e=this.node),void 0===t&&(t=this.lane),new b(e,t,this.body)},b.prototype.encode=function(){var e=[{node:this.node},{lane:this.lane}];return m.concat({"@unlinked":e},this.body)},b.decode=function(e){for(var t,n,o=m.tail(e),i=m.head(e),r=i&&i.length||0,s=0;r>s;s+=1){var c=i[s];void 0!==c.node?t=c.node:void 0!==c.lane?n=c.lane:0===s?t=c:1===s&&(n=c)}return void 0!==t&&void 0!==n?new b(t,n,o):void 0},n.decode=o,n.encode=i,n.parse=r,n.stringify=s,n.Envelope=c,n.RequestEnvelope=a,n.ResponseEnvelope=l,n.MessageEnvelope=u,n.EventMessage=h,n.CommandMessage=p,n.SyncRequest=y,n.SyncedResponse=v,n.LinkRequest=d,n.LinkedResponse=f,n.UnlinkRequest=g,n.UnlinkedResponse=b,n.config=k},{"./config.json":3,"recon-js":"recon-js"}],"swim-client-js":[function(e,t,n){(function(n){"use strict";function o(e){e=e||{},Object.defineProperty(this,"options",{value:e,enumerable:!0}),Object.defineProperty(this,"channels",{value:{},configurable:!0})}function i(){Object.defineProperty(this,"downlinks",{value:[],configurable:!0})}function r(e,t){i.call(this),Object.defineProperty(this,"channel",{value:e}),Object.defineProperty(this,"hostUri",{value:t,enumerable:!0}),Object.defineProperty(this,"downlinks",{value:[],configurable:!0})}function s(e,t,n){i.call(this),Object.defineProperty(this,"channel",{value:e}),Object.defineProperty(this,"hostUri",{value:t,enumerable:!0}),Object.defineProperty(this,"nodeUri",{value:n,enumerable:!0}),Object.defineProperty(this,"downlinks",{value:[],configurable:!0})}function c(e,t,n,o){i.call(this),Object.defineProperty(this,"channel",{value:e}),Object.defineProperty(this,"hostUri",{value:t,enumerable:!0}),Object.defineProperty(this,"nodeUri",{value:n,enumerable:!0}),Object.defineProperty(this,"laneUri",{value:o,enumerable:!0}),Object.defineProperty(this,"downlinks",{value:[],configurable:!0})}function a(e,t){Object.defineProperty(this,"hostUri",{value:e,enumerable:!0}),Object.defineProperty(this,"options",{value:t,enumerable:!0}),Object.defineProperty(this,"uriCache",{value:new p(e),configurable:!0}),Object.defineProperty(this,"downlinks",{value:{},configurable:!0}),Object.defineProperty(this,"sendBuffer",{value:[],configurable:!0}),Object.defineProperty(this,"reconnectTimer",{value:null,writable:!0}),Object.defineProperty(this,"reconnectTimeout",{value:0,writable:!0}),Object.defineProperty(this,"idleTimer",{value:null,writable:!0}),Object.defineProperty(this,"socket",{value:null,writable:!0})}function l(e,t,n,o,i){i=i||{},Object.defineProperty(this,"channel",{value:e}),Object.defineProperty(this,"hostUri",{value:t,enumerable:!0}),Object.defineProperty(this,"nodeUri",{value:n,enumerable:!0}),Object.defineProperty(this,"laneUri",{value:o,enumerable:!0}),Object.defineProperty(this,"options",{value:i,enumerable:!0}),Object.defineProperty(this,"delegate",{value:this,writable:!0})}function u(e,t,n,o,i){l.call(this,e,t,n,o,i)}function h(e,t,n,o,i){l.call(this,e,t,n,o,i)}function p(e,t){t=t||32,Object.defineProperty(this,"baseUri",{value:e,enumerable:!0}),Object.defineProperty(this,"base",{value:f.uri.parse(e)}),Object.defineProperty(this,"size",{value:t,enumerable:!0}),Object.defineProperty(this,"resolveCache",{value:new Array(t)}),Object.defineProperty(this,"unresolveCache",{value:new Array(t)})}var d=e("./config.json"),f=e("recon-js"),y=e("swim-proto-js"),v=n.WebSocket||e("websocket").w3cwebsocket;o.prototype.getOrCreateChannel=function(e){var t=this.channels[e];return void 0===t&&(t=new a(e,this.options),this.channels[e]=t),t},o.prototype.link=function(){var e,t,n,i;2===arguments.length?(i={},n=arguments[1],t=arguments[0],e=o.extractHostUri(t)):3===arguments.length?"object"==typeof arguments[2]?(i=arguments[2],n=arguments[1],t=arguments[0],e=o.extractHostUri(t)):(e=arguments[0],t=o.resolveNodeUri(e,arguments[1]),n=arguments[2],i={}):(e=arguments[0],t=o.resolveNodeUri(e,arguments[1]),n=arguments[2],i=arguments[3]);var r=this.getOrCreateChannel(e);return r.link(t,n,i)},o.prototype.sync=function(){var e,t,n,i;2===arguments.length?(i={},n=arguments[1],t=arguments[0],e=o.extractHostUri(t)):3===arguments.length?"object"==typeof arguments[2]?(i=arguments[2],n=arguments[1],t=arguments[0],e=o.extractHostUri(t)):(e=arguments[0],t=o.resolveNodeUri(e,arguments[1]),n=arguments[2],i={}):(e=arguments[0],t=o.resolveNodeUri(e,arguments[1]),n=arguments[2],i=arguments[3]);var r=this.getOrCreateChannel(e);return r.sync(t,n,i)},o.prototype.command=function(){var e,t,n,i;3===arguments.length?(i=arguments[2],n=arguments[1],t=arguments[0],e=o.extractHostUri(t)):(e=arguments[0],t=o.resolveNodeUri(e,arguments[1]),n=arguments[2],i=arguments[3]);var r=this.getOrCreateChannel(e);r.command(t,n,i)},o.prototype.host=function(e){var t=this.getOrCreateChannel(e);return new r(t,e)},o.prototype.node=function(){var e,t;1===arguments.length?(t=arguments[0],e=o.extractHostUri(t)):(e=arguments[0],t=o.resolveNodeUri(e,arguments[1]));var n=this.getOrCreateChannel(e);return new s(n,e,t)},o.prototype.lane=function(){var e,t,n;2===arguments.length?(n=arguments[1],t=arguments[0],e=o.extractHostUri(t)):(e=arguments[0],t=o.resolveNodeUri(e,arguments[1]),n=arguments[2]);var i=this.getOrCreateChannel(e);return new c(i,e,t,n)},o.prototype.close=function(){var e=this.channels;Object.defineProperty(this,"channels",{value:{},configurable:!0});for(var t in e){var n=e[t];n.close()}},o.extractHostUri=function(e){var t=f.uri.parse(e),n=t.scheme;return"swim"===n?n="ws":"swims"===n&&(n="wss"),f.uri.stringify({scheme:n,authority:t.authority})},o.resolveNodeUri=function(e,t){return f.uri.stringify(f.uri.resolve(e,t))},i.prototype.registerDownlink=function(e){var t=this;Object.defineProperty(e,"onChannelClose",{value:function(){t.unregisterDownlink(e),e.__proto__.onChannelClose.call(e)},configurable:!0}),this.downlinks.push(e)},i.prototype.unregisterDownlink=function(e){for(var t=0,n=this.downlinks.length;n>t;t+=1)if(e===this.downlinks[t])return void this.downlinks.splice(t,1)},i.prototype.close=function(){var e=this.downlinks;Object.defineProperty(this,"downlinks",{value:[],configurable:!0});for(var t=0,n=e.length;n>t;t+=1){var o=e[t];o.__proto__.onChannelClose.call(o)}},r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.link=function(e,t,n){var i=this.channel.link(o.resolveNodeUri(this.hostUri,e),t,n);return this.registerDownlink(i),i},r.prototype.sync=function(e,t,n){var i=this.channel.sync(o.resolveNodeUri(this.hostUri,e),t,n);return this.registerDownlink(i),i},r.prototype.command=function(e,t,n){this.channel.command(o.resolveNodeUri(this.hostUri,e),t,n)},r.prototype.node=function(e){return new s(this.channel,this.hostUri,o.resolveNodeUri(this.hostUri,e))},r.prototype.lane=function(e,t){return new c(this.channel,this.hostUri,o.resolveNodeUri(this.hostUri,e),t)},s.prototype=Object.create(i.prototype),s.prototype.constructor=s,s.prototype.link=function(e,t){var n=this.channel.link(this.nodeUri,e,t);return this.registerDownlink(n),n},s.prototype.sync=function(e,t){var n=this.channel.sync(this.nodeUri,e,t);return this.registerDownlink(n),n},s.prototype.command=function(e,t){this.channel.command(this.nodeUri,e,t)},s.prototype.lane=function(e){return new c(this.channel,this.hostUri,this.nodeUri,e)},c.prototype=Object.create(i.prototype),c.prototype.constructor=c,c.prototype.link=function(e){var t=this.channel.link(this.nodeUri,this.laneUri,e);return this.registerDownlink(t),t},c.prototype.sync=function(e){var t=this.channel.sync(this.nodeUri,this.laneUri,e);return this.registerDownlink(t),t},c.prototype.command=function(e){this.channel.command(this.nodeUri,this.laneUri,e)},Object.defineProperty(a.prototype,"protocols",{get:function(){return this.options.protocols}}),Object.defineProperty(a.prototype,"maxReconnectTimeout",{get:function(){return this.options.maxReconnectTimeout||3e4}}),Object.defineProperty(a.prototype,"idleTimeout",{get:function(){return this.options.idleTimeout||1e3}}),Object.defineProperty(a.prototype,"sendBufferSize",{get:function(){return this.options.sendBufferSize||1024}}),a.prototype.resolve=function(e){return this.uriCache.resolve(e)},a.prototype.unresolve=function(e){return this.uriCache.unresolve(e)},a.prototype.link=function(e,t,n){var o=new u(this,this.hostUri,e,t,n);return this.registerDownlink(o),o},a.prototype.sync=function(e,t,n){var o=new h(this,this.hostUri,e,t,n);return this.registerDownlink(o),o},a.prototype.command=function(e,t,n){var o=new y.CommandMessage(this.unresolve(e),t,n);this.push(o)},a.prototype.registerDownlink=function(e){this.clearIdle();var t=e.nodeUri,n=e.laneUri,o=this.downlinks[t]||{},i=o[n]||[];i.push(e),o[n]=i,this.downlinks[t]=o,this.socket&&this.socket.readyState===this.socket.OPEN?e.onChannelConnect():this.open()},a.prototype.unregisterDownlink=function(e){var t=e.nodeUri,n=e.laneUri,o=this.downlinks[t];if(o){var i=o[n];if(i)for(var r=0,s=i.length;s>r;r+=1)if(i[r]===e){if(i.splice(r,1),0===i.length&&(delete o[n],0===Object.keys(o).length&&(delete this.downlinks[t],this.watchIdle()),this.socket&&this.socket.readyState===this.socket.OPEN)){var c=new y.UnlinkRequest(this.unresolve(t),n);e.onUnlinkRequest(c),this.push(c)}e.onChannelClose()}}},a.prototype.onEnvelope=function(e){e.isEventMessage?this.onEventMessage(e):e.isCommandMessage?this.onCommandMessage(e):e.isLinkRequest?this.onLinkRequest(e):e.isLinkedResponse?this.onLinkedResponse(e):e.isSyncRequest?this.onSyncRequest(e):e.isSyncedResponse?this.onSyncedResponse(e):e.isUnlinkRequest?this.onUnlinkRequest(e):e.isUnlinkedResponse&&this.onUnlinkedResponse(e)},a.prototype.onEventMessage=function(e){var t=this.resolve(e.node),n=e.lane,o=this.downlinks[t];if(o){var i=o[n];if(i)for(var r=e.withAddress(t),s=0,c=i.length;c>s;s+=1){var a=i[s];a.onEventMessage(r)}}},a.prototype.onCommandMessage=function(e){},a.prototype.onLinkRequest=function(e){},a.prototype.onLinkedResponse=function(e){var t=this.resolve(e.node),n=e.lane,o=this.downlinks[t];if(o){var i=o[n];if(i)for(var r=e.withAddress(t),s=0,c=i.length;c>s;s+=1){var a=i[s];a.onLinkedResponse(r)}}},a.prototype.onSyncRequest=function(e){},a.prototype.onSyncedResponse=function(e){var t=this.resolve(e.node),n=e.lane,o=this.downlinks[t];if(o){var i=o[n];if(i)for(var r=e.withAddress(t),s=0,c=i.length;c>s;s+=1){var a=i[s];a.onSyncedResponse(r)}}},a.prototype.onUnlinkRequest=function(e){},a.prototype.onUnlinkedResponse=function(e){var t=this.resolve(e.node),n=e.lane,o=this.downlinks[t];if(o){var i=o[n];if(i){delete o[n],0===Object.keys(o).length&&delete this.downlinks[t];for(var r=e.withAddress(t),s=0,c=i.length;c>s;s+=1){var a=i[s];a.onUnlinkedResponse(r),a.onChannelClose()}}}},a.prototype.onConnect=function(){for(var e in this.downlinks){var t=this.downlinks[e];for(var n in t)for(var o=t[n],i=0,r=o.length;r>i;i+=1){var s=o[i];s.onChannelConnect()}}},a.prototype.onDisconnect=function(){for(var e in this.downlinks){var t=this.downlinks[e];for(var n in t)for(var o=t[n].slice(),i=0,r=o.length;r>i;i+=1){var s=o[i];s.onChannelDisconnect()}}},a.prototype.onError=function(){for(var e in this.downlinks){var t=this.downlinks[e];for(var n in t)for(var o=t[n],i=0,r=o.length;r>i;i+=1){var s=o[i];s.onChannelError()}}},a.prototype.open=function(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null,this.reconnectTimeout=0),this.socket||(this.socket=new v(this.hostUri,this.protocols),this.socket.onopen=this.onWebSocketOpen.bind(this),this.socket.onmessage=this.onWebSocketMessage.bind(this),this.socket.onerror=this.onWebSocketError.bind(this),this.socket.onclose=this.onWebSocketClose.bind(this))},a.prototype.close=function(){this.clearIdle(),this.socket&&(this.socket.close(),this.socket=null);var e=this.downlinks;Object.defineProperty(this,"downlinks",{value:{},configurable:!0});for(var t in e){var n=e[t];for(var o in n)for(var i=n[o],r=0,s=i.length;s>r;r+=1){var c=i[r];c.onChannelClose()}}},a.prototype.reconnect=function(){if(!this.reconnectTimer){if(this.reconnectTimeout){var e=this.maxReconnectTimeout||3e4;this.reconnectTimeout=Math.min(1.8*this.reconnectTimeout,e)}else{var t=1e3*Math.random();this.reconnectTimeout=500+t}this.reconnectTimer=setTimeout(this.open.bind(this),this.reconnectTimeout)}},a.prototype.clearIdle=function(){this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)},a.prototype.watchIdle=function(){this.socket&&this.socket.readyState===this.socket.OPEN&&0===this.sendBuffer.length&&0===Object.keys(this.downlinks).length&&(this.idleTimer=setTimeout(this.checkIdle.bind(this),this.idleTimeout))},a.prototype.checkIdle=function(){0===this.sendBuffer.length&&0===Object.keys(this.downlinks).length&&this.close()},a.prototype.push=function(e){if(this.socket&&this.socket.readyState===this.socket.OPEN){this.clearIdle();var t=y.stringify(e);this.socket.send(t),this.watchIdle()}else e.isCommandMessage&&(this.sendBuffer.length<this.sendBufferSize&&this.sendBuffer.push(e),this.open())},a.prototype.onWebSocketOpen=function(){this.onConnect();for(var e;e=this.sendBuffer.shift();)this.push(e);this.watchIdle()},a.prototype.onWebSocketMessage=function(e){var t=e.data;if("string"==typeof t){var n=y.parse(t);n&&this.onEnvelope(n)}},a.prototype.onWebSocketError=function(){this.onError(),this.clearIdle(),this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,this.socket.close(),this.socket=null)},a.prototype.onWebSocketClose=function(){this.socket=null,this.onDisconnect(),this.clearIdle(),(this.sendBuffer.length>0||Object.keys(this.downlinks).length>0)&&this.reconnect()},Object.defineProperty(l.prototype,"prio",{get:function(){return this.options.prio||0}}),Object.defineProperty(l.prototype,"keepAlive",{get:function(){return this.options.keepAlive||!1},set:function(e){this.options.keepAlive=e}}),Object.defineProperty(l.prototype,"connected",{get:function(){var e=this.channel.socket;return e&&e.readyState===e.OPEN},enumerable:!0}),Object.defineProperty(l.prototype,"onEventMessage",{value:function(e){"function"==typeof this.delegate.onEvent&&this.delegate.onEvent(e)},configurable:!0}),Object.defineProperty(l.prototype,"onLinkRequest",{value:function(e){"function"==typeof this.delegate.onLink&&this.delegate.onLink(e)},configurable:!0}),Object.defineProperty(l.prototype,"onLinkedResponse",{value:function(e){"function"==typeof this.delegate.onLinked&&this.delegate.onLinked(e)},configurable:!0}),Object.defineProperty(l.prototype,"onSyncRequest",{value:function(e){"function"==typeof this.delegate.onSync&&this.delegate.onSync(e)},configurable:!0}),Object.defineProperty(l.prototype,"onSyncedResponse",{value:function(e){"function"==typeof this.delegate.onSynced&&this.delegate.onSynced(e)},configurable:!0}),Object.defineProperty(l.prototype,"onUnlinkRequest",{value:function(e){"function"==typeof this.delegate.onUnlink&&this.delegate.onUnlink(e)},configurable:!0}),Object.defineProperty(l.prototype,"onUnlinkedResponse",{value:function(e){"function"==typeof this.delegate.onUnlinked&&this.delegate.onUnlinked(e)},configurable:!0}),Object.defineProperty(l.prototype,"onChannelConnect",{value:function(){"function"==typeof this.delegate.onConnect&&this.delegate.onConnect()},configurable:!0}),Object.defineProperty(l.prototype,"onChannelDisconnect",{value:function(){"function"==typeof this.delegate.onDisconnect&&this.delegate.onDisconnect(),this.keepAlive||this.close()},configurable:!0}),Object.defineProperty(l.prototype,"onChannelError",{value:function(){"function"==typeof this.delegate.onError&&this.delegate.onError()},configurable:!0}),Object.defineProperty(l.prototype,"onChannelClose",{value:function(){"function"==typeof this.delegate.onClose&&this.delegate.onClose()},configurable:!0}),l.prototype.close=function(){this.channel.unregisterDownlink(this)},u.prototype=Object.create(l.prototype),u.prototype.constructor=u,Object.defineProperty(u.prototype,"onChannelConnect",{value:function(){l.prototype.onChannelConnect.call(this);var e=this.channel.unresolve(this.nodeUri),t=new y.LinkRequest(e,this.laneUri,this.prio);this.onLinkRequest(t),this.channel.push(t)},configurable:!0}),h.prototype=Object.create(l.prototype),h.prototype.constructor=h,Object.defineProperty(h.prototype,"onChannelConnect",{value:function(){l.prototype.onChannelConnect.call(this);var e=this.channel.unresolve(this.nodeUri),t=new y.SyncRequest(e,this.laneUri,this.prio);this.onSyncRequest(t),this.channel.push(t)},configurable:!0}),p.prototype.resolve=function(e){var t=Math.abs(p.hash(e)%this.size),n=this.resolveCache[t];if(n&&n.unresolved===e)return n.resolved;var o=f.uri.stringify(f.uri.resolve(this.base,e));return this.resolveCache[t]={unresolved:e,resolved:o},o},p.prototype.unresolve=function(e){var t=Math.abs(p.hash(e)%this.size),n=this.unresolveCache[t];if(n&&n.resolved===e)return n.unresolved;var o=f.uri.stringify(f.uri.unresolve(this.base,e));return this.unresolveCache[t]={unresolved:o,resolved:e},o},p.rotl=function(e,t){return e<<t|e>>>32-t},p.mix=function(e,t){return t*=3432918353,t=p.rotl(t,15),t*=461845907,e^=t,e=p.rotl(e,13),e=5*e+3864292196},p.mash=function(e){return e^=e>>>16,e*=2246822507,e^=e>>>13,e*=3266489909,e^=e>>>16},p.hash=function(e){for(var t=0,n=0,o=e.length;o>n;n+=1)t=p.mix(t,e.charAt(n));return t=p.mash(t)};var g=new o;g.client=function(e){return new o(e)},g.config=d,t.exports=g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./config.json":1,"recon-js":"recon-js","swim-proto-js":4,websocket:2}]},{},[])("swim-client-js")});
//# sourceMappingURL=swim-client.min.js.map
