!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(t.swim||(t.swim={})).client=e()}}(function(){return function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){var p="function"==typeof require&&require;if(!a&&p)return p(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return i(n?n:e)},l,l.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){"use strict";function r(){if(1===arguments.length){var e=arguments[0];if(void 0===e)return G;if(null===e)return W;if(e.isAttr||e.isSlot){var t=new D;return t.appendField(e),t.state()}return i(e)}return arguments.length>1?o(arguments):G}function i(e){return null===e?W:e.isRecord||e.isAttr||e.isSlot||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||e instanceof Uint8Array||e===W||e===G?e:Array.isArray(e)?o(e):"object"==typeof e?e.toRecon&&"function"==typeof e.toRecon?e.toRecon():s(e):G}function o(e){for(var t=new D,n=e.length,r=0;n>r;){var o=i(e[r]);o.isField?t.appendField(o):t.appendValue(o),r+=1}return t.state()}function s(e){var t,n,i,o=new D,s=e["@"];for(t in s)n=r(t),"string"==typeof n&&(i=r(s[t]),i.isAbsent||o.appendField(new w(n,i)));for(t in e)"@"!==t&&(n=r(t),n.isAbsent||(i=r(e[t]),i.isAbsent||o.appendField(new g(n,i))));return o.state()}function a(e){var t=new C(e),n=(new T).run(t);return n.state()}function p(){var e=new Z;return e.writeBlock(r.apply(null,arguments)),e.state()}function u(e){return void 0===e||null===e||e.isExtant?null:e.isAbsent?void 0:e.isRecord?e.isArray()?l(e):c(e):e}function l(e){for(var t=[],n=e.iterator();!n.isEmpty();){var r=u(n.head());t.push(r),n.step()}return t}function c(e){for(var t,n,r=e.iterator(),i={},o=null,s=0;!r.isEmpty();){var a=r.head();a.isField?(t=u(a.key),n=u(a.value),a.isAttr?(null===o&&(o={}),o[t]=n):i[t]=n):(n=u(a),i[s]=n),r.step(),s+=1}return null!==o&&(i["@"]=o),i}function f(e){if(void 0===e)return new Uint8Array(0);for(var t=new R,n=new C(e);!n.isEmpty();)t.appendBase64Char(n.head()),n.step();return t.state()}function d(e,t){return void 0===t&&(t=W),new w(r(e),r(t))}function h(e,t){return void 0===t&&(t=W),new g(r(e),r(t))}function y(){return new b([],{})}function v(){return new D}function m(e,t){if(e===t)return!0;if(e.isRecord&&t.isRecord)return e.equals(t);if(e.isField&&t.isField)return e.equals(t);if(e instanceof Uint8Array&&t instanceof Uint8Array&&e.length===t.length){for(var n=0,r=e.length;r>n&&e[n]===t[n];)n+=1;if(n===r)return!0}return!1}function b(e,t){if(void 0===t){t={};for(var n=0,r=e.length;r>n;){var i=e[n];i.isField&&(t[i.key]=i.value),n+=1}}var o=function(n){var r=t[n];return void 0===r&&"number"==typeof n&&(r=e[n]),r};return o.__proto__=b.prototype,Object.defineProperty(o,"items",{value:e}),Object.defineProperty(o,"index",{value:t}),o}function E(){}function w(e,t){E.call(this),Object.defineProperty(this,"key",{enumerable:!0,value:e}),void 0===t&&(t=W),Object.defineProperty(this,"value",{enumerable:!0,value:t})}function g(e,t){E.call(this),Object.defineProperty(this,"key",{enumerable:!0,value:e}),void 0===t&&(t=W),Object.defineProperty(this,"value",{enumerable:!0,value:t})}function O(e,t){Object.defineProperty(this,"items",{value:e}),Object.defineProperty(this,"index",{value:t||0,writable:!0})}function D(){Object.defineProperty(this,"items",{value:[]}),Object.defineProperty(this,"index",{value:{}})}function k(){Object.defineProperty(this,"items",{value:null,writable:!0}),Object.defineProperty(this,"index",{value:null,writable:!0}),Object.defineProperty(this,"value",{value:null,writable:!0})}function C(e,t){Object.defineProperty(this,"string",{value:e||""}),Object.defineProperty(this,"index",{value:t||0,writable:!0})}function x(){}function j(){Object.defineProperty(this,"string",{value:"",writable:!0})}function R(){Object.defineProperty(this,"buffer",{value:null,writable:!0}),Object.defineProperty(this,"offset",{value:0,writable:!0}),Object.defineProperty(this,"aliased",{value:!0,writable:!0}),Object.defineProperty(this,"p",{value:0,writable:!0}),Object.defineProperty(this,"q",{value:0,writable:!0}),Object.defineProperty(this,"r",{value:0,writable:!0}),Object.defineProperty(this,"s",{value:0,writable:!0})}function P(e){return 32===e||9===e}function S(e){return 10===e||13===e}function F(e){return P(e)||S(e)}function _(e){return e>=65&&90>=e||95===e||e>=97&&122>=e||e>=192&&214>=e||e>=216&&246>=e||e>=248&&767>=e||e>=880&&893>=e||e>=895&&8191>=e||e>=8204&&8205>=e||e>=8304&&8591>=e||e>=11264&&12271>=e||e>=12289&&55295>=e||e>=63744&&64975>=e||e>=65008&&65533>=e||e>=65536&&983039>=e}function A(e){return 45===e||e>=48&&57>=e||e>=65&&90>=e||95===e||e>=97&&122>=e||183===e||e>=192&&214>=e||e>=216&&246>=e||e>=248&&893>=e||e>=895&&8191>=e||e>=8204&&8205>=e||e>=8255&&8256>=e||e>=8304&&8591>=e||e>=11264&&12271>=e||e>=12289&&55295>=e||e>=63744&&64975>=e||e>=65008&&65533>=e||e>=65536&&983039>=e}function q(e){return e>=48&&57>=e||e>=65&&90>=e||e>=97&&122>=e||43===e||45===e||47===e||95===e}function T(e){x.call(this),this.value=e||new I}function I(e,t,n,r){x.call(this),this.builder=e||null,this.key=t||null,this.value=n||null,this.s=r||1}function N(e,t,n){x.call(this),this.ident=e||new B,this.value=t||new I,this.s=n||1}function U(e,t,n,r){x.call(this),this.builder=e||null,this.field=t||null,this.value=n||null,this.s=r||1}function H(e,t,n,r){x.call(this),this.builder=e||null,this.field=t||null,this.value=n||null,this.s=r||1}function M(e,t,n,r){x.call(this),this.builder=e||null,this.key=t||null,this.value=n||null,this.s=r||1}function L(e,t,n,r){x.call(this),this.builder=e||null,this.text=t||null,this.value=n||null,this.s=r||1}function B(e,t){x.call(this),this.builder=e||null,this.s=t||1}function z(e,t){x.call(this),this.text=e||null,this.s=t||1}function V(e,t){x.call(this),this.builder=e||null,this.s=t||1}function $(e,t){x.call(this),this.data=e||null,this.s=t||1}function Z(e){Object.defineProperty(this,"builder",{value:e||new j})}b.prototype=Object.create(Function.prototype),b.prototype.constructor=b,Object.defineProperty(b.prototype,"isRecord",{enumerable:!0,value:!0}),Object.defineProperty(b.prototype,"size",{enumerable:!0,get:function(){return this.items.length}}),b.prototype.isEmpty=function(){return 0===this.items.length},b.prototype.isArray=function(){return this.items.length>=0&&0===Object.getOwnPropertyNames(this.index).length},b.prototype.isBlockSafe=function(){for(var e=this.iterator();!e.isEmpty();)if(e.next().isAttr)return!1;return!0},b.prototype.isMarkupSafe=function(){var e=this.iterator();if(e.isEmpty()||!e.next().isAttr)return!1;for(;!e.isEmpty();)if(e.next().isAttr)return!1;return!0},b.prototype.contains=function(e){return void 0!==this(e)},b.prototype.head=function(){return this.items.length>0?this.items[0]:G},b.prototype.tail=function(){return new b(this.items.slice(1))},b.prototype.body=function(){return new b(this.items.slice(0,-1))},b.prototype.foot=function(){return this.items.length>0?this.items[this.items.length-1]:G},b.prototype.target=function(){for(var e=this.iterator();!e.isEmpty();){var t=e.next();if(!t.isField)return t}return G},b.prototype.concat=function(){var e=new D;e.appendRecord(this);var t=r.apply(null,arguments);return t.isRecord?e.appendRecord(t):e.appendValue(t),e.state()},b.prototype.iterator=function(){return new O(this.items)},b.prototype.forEach=function(e){for(var t=this.iterator();!t.isEmpty();)e(t.next())},b.prototype.equals=function(e){for(var t=this.iterator(),n=e.iterator();!t.isEmpty()&&!n.isEmpty();)if(!m(t.next(),n.next()))return!1;return t.isEmpty()&&n.isEmpty()},b.prototype.toString=function(){var e=new Z;return e.writeRecord(this),e.state()},Object.defineProperty(E.prototype,"isField",{enumerable:!0,value:!0}),Object.defineProperty(E.prototype,"isAttr",{enumerable:!0,value:!1}),Object.defineProperty(E.prototype,"isSlot",{enumerable:!0,value:!1}),w.prototype=Object.create(E.prototype),w.prototype.constructor=w,Object.defineProperty(w.prototype,"isAttr",{enumerable:!0,value:!0}),w.prototype.equals=function(e){return e.isAttr&&m(this.key,e.key)&&m(this.value,e.value)},w.prototype.toString=function(){var e=new Z;return e.writeAttr(this),e.state()},g.prototype=Object.create(E.prototype),g.prototype.constructor=g,Object.defineProperty(g.prototype,"isSlot",{enumerable:!0,value:!0}),g.prototype.equals=function(e){return e.isSlot&&m(this.key,e.key)&&m(this.value,e.value)},g.prototype.toString=function(){var e=new Z;return e.writeItem(this),e.state()};var W={};Object.defineProperty(W,"isExtant",{enumerable:!0,value:!0});var G={};Object.defineProperty(G,"isAbsent",{enumerable:!0,value:!0}),O.prototype.isEmpty=function(){return this.index>=this.items.length},O.prototype.head=function(){if(this.index>=this.items.length)throw"head of empty iterator";return this.items[this.index]},O.prototype.step=function(){if(this.index>=this.items.length)throw"empty iterator step";this.index+=1},O.prototype.next=function(){if(this.index>=this.items.length)return null;var e=this.items[this.index];return this.index+=1,e},O.prototype.dup=function(){return new O(this.items,this.index)},O.prototype.toRecord=function(){return new b(this.items.slice(this.index))},D.prototype.appendField=function(e){this.items.push(e),this.index[e.key]=e.value},D.prototype.appendValue=function(e){this.items.push(e)},D.prototype.appendRecord=function(e){for(var t=e.iterator();!t.isEmpty();){var n=t.next();n.isField?this.appendField(n):this.appendValue(n)}},D.prototype.attr=function(e,t){return this.appendField(d(e,t)),this},D.prototype.slot=function(e,t){return this.appendField(h(e,t)),this},D.prototype.item=function(e){return this.appendValue(i(e)),this},D.prototype.state=function(){return new b(this.items,this.index)},k.prototype.appendField=function(e){null===this.items&&(this.items=[],this.index={},null!==this.value&&(this.items.push(this.value),this.value=null)),this.items.push(e),this.index[e.key]=e.value},k.prototype.appendValue=function(e){null!==this.items?this.items.push(e):null===this.value?this.value=e:(this.items=[],this.index={},this.items.push(this.value),this.value=null,this.items.push(e))},k.prototype.state=function(){return null!==this.value?this.value:null!==this.items?new b(this.items,this.index):G},C.prototype.isDone=function(){return!1},C.prototype.isEmpty=function(){return this.index>=this.string.length},C.prototype.head=function(){var e=this.string.charCodeAt(this.index);if(55295>=e||e>=57344)return e;if(56319>=e&&this.index+1<this.string.length){var t=this.string.charCodeAt(this.index+1);return t>=56320&&57343>=t?((1023&e)<<10|1023&t)+65536:65533}return 65533},C.prototype.step=function(){var e=this.string.charCodeAt(this.index);if(55295>=e||e>=57344)this.index+=1;else if(56319>=e&&this.index+1<this.string.length){var t=this.string.charCodeAt(this.index+1);t>=56320&&57343>=t?this.index+=2:this.index+=1}else this.index+=1},C.Done={isDone:function(){return!0},isEmpty:function(){return!0},head:function(){throw"head of empty iterator"},step:function(){throw"empty iterator step"}},C.Done.prototype=Object.create(C.prototype),x.prototype.isCont=function(){return!0},x.prototype.isDone=function(){return!1},x.prototype.isError=function(){return!1},x.prototype.feed=function(e){return this},x.prototype.run=function(e){for(var t=this;!e.isEmpty()&&t.isCont();)t=t.feed(e);return e.isEmpty()&&!e.isDone()&&t.isCont()&&(t=t.feed(C.Done)),t},x.Done=function(e){x.call(this),this.value=e},x.Done.prototype=Object.create(x.prototype),x.Done.prototype.constructor=x.Done,x.Done.prototype.isCont=function(){return!1},x.Done.prototype.isDone=function(){return!0},x.Done.prototype.feed=function(e){return this},x.Done.prototype.state=function(){return this.value},x.Error=function(e){x.call(this),this.error=e},x.Error.prototype=Object.create(x.prototype),x.Error.prototype.constructor=x.Error,x.Error.prototype.isCont=function(){return!1},x.Error.prototype.isError=function(){return!0},x.Error.prototype.feed=function(e){return this},x.Error.prototype.state=function(){throw this.error},x.unexpectedEOF=new x.Error("unexpected end of input"),j.prototype.append=function(e){if(e>=0&&55295>=e||e>=57344&&65535>=e)this.string+=String.fromCharCode(e);else if(e>=65536&&1114111>=e){var t=e-65536;this.string+=String.fromCharCode(55296|t>>>10,56320|1023&t)}else this.string+=String.fromCharCode(65533)},j.prototype.appendString=function(e){for(var t=new C(e);!t.isEmpty();)this.append(t.head()),t.step()},j.prototype.state=function(){return this.string},R.prototype.prepare=function(e){function t(e,t){var n=Math.max(e,t)-1;return n|=n>>1,n|=n>>2,n|=n>>4,n|=n>>8,n+1}if(this.aliased||e>this.buffer.length){var n=new Uint8Array(t(256,e));this.buffer&&n.set(this.buffer),this.buffer=n,this.aliased=!1}},R.prototype.appendByte=function(e){this.prepare(this.offset+1),this.buffer[this.offset]=e,this.offset+=1},R.prototype.decodeBase64Digit=function(e){return e>=65&&90>=e?e-65:e>=97&&122>=e?e-71:e>=48&&57>=e?e+4:43===e||45===e?62:47===e||95===e?63:void 0},R.prototype.decodeBase64Quantum=function(){var e=this.decodeBase64Digit(this.p),t=this.decodeBase64Digit(this.q);if(61!==this.r){var n=this.decodeBase64Digit(this.r);if(61!==this.s){var r=this.decodeBase64Digit(this.s);this.appendByte(e<<2|t>>>4),this.appendByte(t<<4|n>>>2),this.appendByte(n<<6|r)}else this.appendByte(e<<2|t>>>4),this.appendByte(t<<4|n>>>2)}else{if(61!==this.s)throw"incomplete base64 quantum";this.appendByte(e<<2|t>>>4)}},R.prototype.appendBase64Char=function(e){0===this.p?this.p=e:0===this.q?this.q=e:0===this.r?this.r=e:(this.s=e,this.decodeBase64Quantum(),this.s=0,this.r=0,this.q=0,this.p=0)},R.prototype.state=function(e){if(this.buffer){if(this.buffer.length!==this.offset){var t=new Uint8Array(this.offset);t.set(this.buffer.subarray(0,this.offset)),this.buffer=t}}else this.buffer=new Uint8Array(0);return this.aliased=!0,this.buffer},T.prototype=Object.create(x.prototype),T.prototype.constructor=T,T.prototype.feed=function(e){for(var t=this.value;(!e.isEmpty()||e.isDone())&&t.isCont();)t=t.feed(e);if(t.isError())return t;if(t.isDone()){if(!e.isEmpty())return new x.Error({found:e.head()});if(e.isDone())return t}return new T(t)},I.prototype=Object.create(x.prototype),I.prototype.constructor=I,I.prototype.feed=function(e){for(var t=0,n=this.s,r=this.value,i=this.key,o=this.builder||new k;!e.isEmpty()||e.isDone();){if(1===n){for(;!e.isEmpty()&&(t=e.head(),F(t));)e.step();if(e.isEmpty()){if(e.isDone())return new x.Done(o.state())}else{if(!(64===t||123===t||91===t||_(t)||34===t||45===t||t>=48&&57>=t||37===t))return new x.Error({expected:"block value",found:t});n=2}}if(2===n){for(i=i||new U;(!e.isEmpty()||e.isDone())&&i.isCont();)i=i.feed(e);if(i.isDone())n=3;else if(i.isError())return i}if(3===n){for(;!e.isEmpty()&&(t=e.head(),P(t));)e.step();if(e.isEmpty()){if(e.isDone())return o.appendValue(i.state()),new x.Done(o.state())}else 58===t?(e.step(),n=4):(o.appendValue(i.state()),i=null,n=6)}if(4===n){for(;!e.isEmpty()&&P(e.head());)e.step();if(e.isEmpty()){if(e.isDone())return o.appendField(new g(i.state())),new x.Done(o.state())}else n=5}if(5===n){for(r=r||new U;(!e.isEmpty()||e.isDone())&&r.isCont();)r=r.feed(e);if(r.isDone())o.appendField(new g(i.state(),r.state())),i=null,r=null,n=6;else if(r.isError())return r}if(6===n){for(;!e.isEmpty()&&(t=e.head(),P(t));)e.step();if(e.isEmpty()){if(e.isDone())return new x.Done(o.state())}else{if(44!==t&&59!==t&&!S(t))return new x.Done(o.state());e.step(),n=1}}}return new I(o,i,r,n)},N.prototype=Object.create(x.prototype),N.prototype.constructor=N,N.prototype.feed=function(e){var t=0,n=this.s,r=this.value,i=this.ident;if(1===n)if(e.isEmpty()||(t=e.head(),64!==t)){if(!e.isEmpty())return new x.Error({expected:"'@'",found:t});if(e.isDone())return x.unexpectedEOF}else e.step(),n=2;if(2===n)if(i=i.feed(e),i.isDone())n=3;else if(i.isError())return i;if(3===n)if(e.isEmpty()||40!==e.head()){if(!e.isEmpty()||e.isDone())return new x.Done(new w(i.state()))}else e.step(),n=4;if(4===n){for(;!e.isEmpty()&&(t=e.head(),F(t));)e.step();if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else{if(41===t)return e.step(),new x.Done(new w(i.state()));n=5}}if(5===n){for(;(!e.isEmpty()||e.isDone())&&r.isCont();)r=r.feed(e);if(r.isDone())n=6;else if(r.isError())return r}if(6===n){for(;!e.isEmpty()&&(t=e.head(),F(t));)e.step();if(!e.isEmpty())return 41===t?(e.step(),new x.Done(new w(i.state(),r.state()))):new x.Error({expected:"')'",found:t});if(e.isDone())return x.unexpectedEOF}return new N(i,r,n)},U.prototype=Object.create(x.prototype),U.prototype.constructor=U,U.prototype.feed=function(e){for(var t=0,n=this.s,r=this.value,i=this.field,o=this.builder;!e.isEmpty()||e.isDone();){if(1===n)if(e.isEmpty()){if(e.isDone())return o?new x.Done(o.state()):new x.Done(G)}else if(t=e.head(),64===t)i=new N,n=2;else if(123===t)o=o||new D,r=new M(o),n=5;else if(91===t)o=o||new D,r=new L(o),n=5;else if(_(t))r=new B,n=4;else if(34===t)r=new z,n=4;else if(45===t||t>=48&&57>=t)r=new V,n=4;else{if(37!==t)return o?new x.Done(o.state()):new x.Done(G);r=new $,n=4}if(2===n){for(;(!e.isEmpty()||e.isDone())&&i.isCont();)i=i.feed(e);if(i.isDone())o=o||new k,o.appendField(i.state()),i=null,n=3;else if(i.isError())return i}if(3===n){for(;!e.isEmpty()&&P(e.head());)e.step();if(e.isEmpty()){if(e.isDone())return new x.Done(o.state())}else n=1}if(4===n){for(;(!e.isEmpty()||e.isDone())&&r.isCont();)r=r.feed(e);if(r.isDone())o=o||new k,o.appendValue(r.state()),r=null,n=6;else if(r.isError())return r}if(5===n){for(;(!e.isEmpty()||e.isDone())&&r.isCont();)r=r.feed(e);if(r.isDone())r=null,n=6;else if(r.isError())return r}if(6===n){for(;!e.isEmpty()&&P(e.head());)e.step();if(e.isEmpty()||64!==e.head())return new x.Done(o.state());n=1}}return new U(o,i,r,n)},H.prototype=Object.create(x.prototype),H.prototype.constructor=H,H.prototype.feed=function(e){var t=0,n=this.s,r=this.value,i=this.field,o=this.builder;if(1===n)if(e.isEmpty()){if(e.isDone())return o?new x.Done(o.state()):new x.Done(W)}else if(t=e.head(),64===t)i=new N,n=2;else if(123===t)o?(r=new M(o),n=5):(r=new M,n=4);else{if(91!==t)return o?new x.Done(o.state()):new x.Done(W);o?(r=new L(o),n=5):(r=new L,n=4)}if(2===n){for(;(!e.isEmpty()||e.isDone())&&i.isCont();)i=i.feed(e);if(i.isDone())o=o||new k,o.appendField(i.state()),i=null,n=3;else if(i.isError())return i}if(3===n)if(e.isEmpty()){if(e.isDone())return new x.Done(o.state())}else if(t=e.head(),123===t)r=new M(o),n=5;else{if(91!==t)return new x.Done(o.state());r=new L(o),n=5}if(4===n){for(;(!e.isEmpty()||e.isDone())&&r.isCont();)r=r.feed(e);if(r.isDone())return o=o||new k,o.appendValue(r.state()),new x.Done(o.state());if(r.isError())return r}if(5===n){for(;(!e.isEmpty()||e.isDone())&&r.isCont();)r=r.feed(e);if(r.isDone())return new x.Done(o.state());if(r.isError())return r}return new H(o,i,r,n)},M.prototype=Object.create(x.prototype),M.prototype.constructor=M,M.prototype.feed=function(e){var t=0,n=this.s,r=this.value,i=this.key,o=this.builder||new D;if(1===n)if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else{if(t=e.head(),123!==t)return new x.Error({expected:"'{'",found:t});e.step(),n=2}for(;!e.isEmpty()||e.isDone();){if(2===n){for(;!e.isEmpty()&&(t=e.head(),F(t));)e.step();if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else{if(125===t)return e.step(),new x.Done(o.state());n=3}}if(3===n){for(i=i||new U;(!e.isEmpty()||e.isDone())&&i.isCont();)i=i.feed(e);if(i.isDone())n=4;else if(i.isError())return i}if(4===n){for(;!e.isEmpty()&&(t=e.head(),P(t));)e.step();if(e.isEmpty()){if(e.isDone())return o.appendValue(i.state()),new x.Done(o.state())}else 58===t?(e.step(),n=5):(o.appendValue(i.state()),i=null,n=7)}if(5===n){for(;!e.isEmpty()&&P(e.head());)e.step();if(e.isEmpty()){if(e.isDone())return o.appendField(new g(i.state())),new x.Done(o.state())}else n=6}if(6===n){for(r=r||new U;(!e.isEmpty()||e.isDone())&&r.isCont();)r=r.feed(e);if(r.isDone())o.appendField(new g(i.state(),r.state())),i=null,r=null,n=7;else if(r.isError())return r}if(7===n){for(;!e.isEmpty()&&(t=e.head(),P(t));)e.step();if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else{if(44!==t&&59!==t&&!S(t))return 125===t?(e.step(),new x.Done(o.state())):new x.Error({expected:"'}', ';', ',', or newline",found:t});e.step(),n=2}}}return new M(o,i,r,n)},L.prototype=Object.create(x.prototype),L.prototype.constructor=L,L.prototype.feed=function(e){var t=0,n=this.s,r=this.value,i=this.text,o=this.builder;if(1===n)if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else{if(t=e.head(),91!==t)return new x.Error({expected:"'['",found:t});e.step(),n=2}for(;!e.isEmpty()||e.isDone();){if(2===n){for(;!e.isEmpty()&&(t=e.head(),64!==t&&91!==t&&92!==t&&93!==t&&123!==t&&125!==t);)e.step(),i=i||new j,i.append(t);if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else{if(93===t)return e.step(),o=o||new D,i&&o.appendValue(i.state()),new x.Done(o.state());64===t?(o=o||new D,i&&(o.appendValue(i.state()),i=null),r=new H,n=3):123===t?(o=o||new D,i&&(o.appendValue(i.state()),i=null),r=new M(o),n=4):91===t?(o=o||new D,i&&(o.appendValue(i.state()),i=null),r=new L(o),n=4):92===t?(e.step(),n=5):new x.Error({found:t})}}if(3===n){for(;(!e.isEmpty()||e.isDone())&&r.isCont();)r=r.feed(e);if(r.isDone())o.appendValue(r.state()),r=null,n=2;else if(r.isError())return r}if(4===n){for(;(!e.isEmpty()||e.isDone())&&r.isCont();)r=r.feed(e);if(r.isDone())r=null,n=2;else if(r.isError())return r}if(5===n)if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else if(t=e.head(),i=i||new j,34===t||47===t||64===t||91===t||92===t||93===t||123===t||125===t)e.step(),i.append(t),n=2;else if(98===t)e.step(),i.append(8),n=2;else if(102===t)e.step(),i.append(12),n=2;else if(110===t)e.step(),i.append(10),n=2;else if(114===t)e.step(),i.append(13),n=2;else{if(116!==t)return new x.Error({expected:"escape character",found:t});e.step(),i.append(9),n=2}}return new L(o,i,r,n)},B.prototype=Object.create(x.prototype),B.prototype.constructor=B,B.prototype.feed=function(e){var t=0,n=this.s,r=this.builder;if(1===n)if(!e.isEmpty()&&(t=e.head(),_(t)))r=r||new j,e.step(),r.append(t),n=2;else{if(!e.isEmpty())return new x.Error({expected:"identitifer",found:t});if(e.isDone())return x.unexpectedEOF}if(2===n){for(;!e.isEmpty()&&(t=e.head(),A(t));)e.step(),r.append(t);if(!e.isEmpty()||e.isDone()){var i=r.state();return"true"===i?i=!0:"false"===i&&(i=!1),new x.Done(i)}}return new B(r,n)},z.prototype=Object.create(x.prototype),z.prototype.constructor=z,z.prototype.feed=function(e){var t=0,n=this.s,r=this.text;if(1===n)if(e.isEmpty()||(t=e.head(),34!==t)){if(!e.isEmpty())return new x.Error({expected:"'\"'",found:t});if(e.isDone())return x.unexpectedEOF}else e.step(),n=2;for(;!e.isEmpty()||e.isDone();){if(2===n){for(r=r||new j;!e.isEmpty()&&(t=e.head(),34!==t&&92!==t);)e.step(),r.append(t);if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else{if(34===t)return e.step(),new x.Done(r.state());92===t&&(e.step(),n=3)}}if(3===n)if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else if(t=e.head(),34===t||47===t||64===t||91===t||92===t||93===t||123===t||125===t)e.step(),r.append(t),n=2;else if(98===t)e.step(),r.append(8),n=2;else if(102===t)e.step(),r.append(12),n=2;else if(110===t)e.step(),r.append(10),n=2;else if(114===t)e.step(),r.append(13),n=2;else{if(116!==t)return new x.Error({expected:"escape character",found:t});e.step(),r.append(9),n=2}}return new z(r,n)},V.prototype=Object.create(x.prototype),V.prototype.constructor=V,V.prototype.feed=function(e){var t=0,n=this.s,r=this.builder||new j;if(1===n)if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else t=e.head(),45===t&&(e.step(),r.append(t)),n=2;if(2===n)if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else if(t=e.head(),48===t)e.step(),r.append(t),n=4;else{if(!(t>=49&&57>=t))return new x.Error({expected:"digit",found:t});e.step(),r.append(t),n=3}if(3===n){for(;!e.isEmpty()&&(t=e.head(),t>=48&&57>=t);)e.step(),r.append(t);if(e.isEmpty()){if(e.isDone())return new x.Done(Number(r.state()))}else n=4}if(4===n)if(e.isEmpty()){if(e.isDone())return new x.Done(Number(r.state()))}else if(t=e.head(),46===t)e.step(),r.append(t),n=5;else{if(69!==t&&101!==t)return new x.Done(Number(r.state()));e.step(),r.append(t),n=8}if(5===n)if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else{if(t=e.head(),!(t>=48&&57>=t))return new x.Error({expected:"digit",found:t});e.step(),r.append(t),n=6}if(6===n){for(;!e.isEmpty()&&(t=e.head(),t>=48&&57>=t);)e.step(),r.append(t);if(e.isEmpty()){if(e.isDone())return new x.Done(Number(r.state()))}else n=7}if(7===n){if(t=e.head(),69!==t&&101!==t)return new x.Done(Number(r.state()));e.step(),r.append(t),n=8}if(8===n)if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else t=e.head(),(43===t||45===t)&&(e.step(),r.append(t)),n=9;if(9===n)if(e.isEmpty()){if(e.isDone())return x.unexpectedEOF}else{if(t=e.head(),!(t>=48&&57>=t))return new x.Error({expected:"digit",found:t});e.step(),r.append(t),n=10}if(10===n){for(;!e.isEmpty()&&(t=e.head(),t>=48&&57>=t);)e.step(),r.append(t);if(!e.isEmpty()||e.isDone())return new x.Done(Number(r.state()))}return new V(r,n)},$.prototype=Object.create(x.prototype),$.prototype.constructor=$,$.prototype.feed=function(e){var t=0,n=this.s,r=this.data||new R;if(1===n)if(e.isEmpty()||(t=e.head(),37!==t)){if(!e.isEmpty())return new x.Error({expected:"'%'",found:t});if(e.isDone())return x.unexpectedEOF}else e.step(),n=2;for(;!e.isEmpty()||e.isDone();){if(2===n)if(!e.isEmpty()&&(t=e.head(),q(t)))e.step(),r.appendBase64Char(t),n=3;else if(!e.isEmpty()||e.isDone())return new x.Done(r.state());if(3===n)if(!e.isEmpty()&&(t=e.head(),q(t)))e.step(),r.appendBase64Char(t),n=4;else{if(!e.isEmpty())return new x.Error({expected:"base64 digit",found:t});if(e.isDone())return x.unexpectedEOF}if(4===n)if(!e.isEmpty()&&(t=e.head(),q(t)||61===t))e.step(),r.appendBase64Char(t),n=61!==t?5:6;else{if(!e.isEmpty())return new x.Error({expected:"base64 digit",found:t});if(e.isDone())return x.unexpectedEOF}if(5===n)if(!e.isEmpty()&&(t=e.head(),q(t)||61===t)){if(e.step(),r.appendBase64Char(t),61===t)return new x.Done(r.state());n=2}else{if(!e.isEmpty())return new x.Error({expected:"base64 digit",found:t});if(e.isDone())return x.unexpectedEOF}else if(6===n){if(!e.isEmpty()&&(t=e.head(),61===t))return e.step(),r.appendBase64Char(t),new x.Done(r.state());if(!e.isEmpty())return new x.Error({expected:"'='",found:t});if(e.isDone())return x.unexpectedEOF}}return new $(r,n)},Z.prototype.writeValue=function(e){e.isRecord?this.writeRecord(e):"string"==typeof e?this.writeText(e):"number"==typeof e?this.writeNumber(e):"boolean"==typeof e?this.writeBool(e):e instanceof Uint8Array&&this.writeData(e)},Z.prototype.writeAttr=function(e){this.builder.append(64),this.writeIdent(e.key),e.value.isExtant||(this.builder.append(40),this.writeBlock(e.value),this.builder.append(41))},Z.prototype.writeItem=function(e){e.isField?(this.writeValue(e.key),this.builder.append(58),e.value.isExtant||this.writeValue(e.value)):this.writeValue(e)},Z.prototype.writeBlock=function(e){e.isRecord?e.isEmpty()?(this.builder.append(123),this.builder.append(125)):this.writeItems(e,e.isBlockSafe(),!1):this.writeValue(e)},Z.prototype.writeRecord=function(e){e.isEmpty()?(this.builder.append(123),this.builder.append(125)):this.writeItems(e,!1,!1)},Z.prototype.writeItems=function(e,t,n){for(var r=e.iterator(),i=!1,o=!1,s=!0;!r.isEmpty();){var a=r.head();r.step(),o&&a.isAttr&&(i&&(this.builder.append(125),i=!1),this.builder.append(93),o=!1),a.isAttr?(i?(this.builder.append(125),i=!1):o&&(this.builder.append(93),o=!1),this.writeAttr(a),s=!1):o&&"string"==typeof a?(i&&(this.builder.append(125),i=!1),this.writeMarkupText(a)):i?(s?s=!1:this.builder.append(44),this.writeItem(a)):o?a.isRecord&&a.isMarkupSafe()?(this.writeItems(a,!1,!0),r.isEmpty()||"string"!=typeof r.head()?r.isEmpty()||r.head().isAttr?(this.builder.append(93),o=!1):(this.builder.append(123),i=!0,s=!0):(this.writeMarkupText(r.head()),r.step())):(this.builder.append(123),this.writeItem(a),i=!0,s=!1):"string"!=typeof a||r.isEmpty()||r.head().isField||"string"==typeof r.head()||"boolean"==typeof r.head()?t&&!i?(s?s=!1:this.builder.append(44),this.writeItem(a)):n&&"string"==typeof a&&r.isEmpty()?(this.builder.append(91),this.writeMarkupText(a),this.builder.append(93)):n||a.isField||a.isRecord||!(!s&&r.isEmpty()||!r.isEmpty()&&r.head().isAttr)?(this.builder.append(123),this.writeItem(a),i=!0,s=!1):(!s&&("string"==typeof a&&this.isIdent(a)||"number"==typeof a||"boolean"==typeof a)&&this.builder.append(32),this.writeValue(a)):(this.builder.append(91),this.writeMarkupText(a),o=!0)}i?this.builder.append(125):o&&this.builder.append(93)},Z.prototype.isIdent=function(e){var t=new C(e);if(t.isEmpty()||!_(t.head()))return!1;for(t.step();!t.isEmpty()&&A(t.head());)t.step();return t.isEmpty()},Z.prototype.writeText=function(e){this.isIdent(e)?this.writeIdent(e):this.writeString(e)},Z.prototype.writeIdent=function(e){this.builder.appendString(e)},Z.prototype.writeString=function(e){var t=new C(e);for(this.builder.append(34);!t.isEmpty();){var n=t.head();switch(n){case 34:case 92:this.builder.append(92),this.builder.append(n);break;case 8:this.builder.append(92),this.builder.append(98);break;case 12:this.builder.append(92),this.builder.append(102);break;case 10:this.builder.append(92),this.builder.append(110);break;case 13:this.builder.append(92),this.builder.append(114);break;case 9:this.builder.append(92),this.builder.append(116);break;default:this.builder.append(n)}t.step()}this.builder.append(34)},Z.prototype.writeMarkupText=function(e){for(var t=new C(e);!t.isEmpty();){var n=t.head();switch(n){case 64:case 91:case 92:case 93:case 123:case 125:this.builder.append(92),this.builder.append(n);break;default:this.builder.append(n)}t.step()}},Z.prototype.writeNumber=function(e){this.builder.appendString(e.toString())},Z.prototype.writeBool=function(e){this.builder.appendString(e.toString())},Z.prototype.writeData=function(e){function t(e){return e>=0&&26>e?e+65:e>=26&&52>e?e+71:e>=52&&62>e?e-4:62===e?43:63===e?47:void 0}this.builder.append(37);for(var n,r,i,o=0,s=e.length;s>o+2;)n=e[o],r=e[o+1],i=e[o+2],this.builder.append(t(n>>>2)),this.builder.append(t(63&(n<<4|r>>>4))),this.builder.append(t(63&(r<<2|i>>>6))),this.builder.append(t(63&i)),o+=3;s>o+1?(n=e[o],r=e[o+1],this.builder.append(t(n>>>2)),this.builder.append(t(63&(n<<4|r>>>4))),this.builder.append(t(r<<2&63)),this.builder.append(61),o+=2):s>o&&(n=e[o],this.builder.append(t(n>>>2)),this.builder.append(t(n<<4&63)),this.builder.append(61),this.builder.append(61),o+=1)},Z.prototype.state=function(){return this.builder.state()},t.exports=function(){return r.apply(null,arguments)},n=t.exports,n.parse=a,n.stringify=p,n.objectify=u,n.Record=b,n.Field=E,n.Attr=w,n.Slot=g,n.attr=d,n.slot=h,n.base64=f,n.extant=W,n.absent=G,n.empty=y,n.builder=v,n.compare=m},{}],2:[function(e,t,n){"use strict";function r(e){if(e.isRecord){var t=e.head();if(t.isField)switch(t.key){case"event":return c.decode(e);case"command":return f.decode(e);case"sync":return d.decode(e);case"synced":return h.decode(e);case"link":return y.decode(e);case"linked":return v.decode(e);case"unlink":return m.decode(e);case"unlinked":return b.decode(e);case"get":return E.decode(e);case"put":return w.decode(e);case"state":return g.decode(e)}}}function i(e){return e.encode()}function o(e){return r(O.parse(e))}function s(e){return O.stringify(i(e))}function a(){}function p(){a.call(this)}function u(){a.call(this)}function l(){a.call(this)}function c(e,t,n,r){l.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e}),Object.defineProperty(this,"lane",{enumerable:!0,value:t}),Object.defineProperty(this,"via",{enumerable:!0,value:n||O.absent}),Object.defineProperty(this,"body",{enumerable:!0,
value:r||O.empty()})}function f(e,t,n,r){l.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e}),Object.defineProperty(this,"lane",{enumerable:!0,value:t}),Object.defineProperty(this,"via",{enumerable:!0,value:n||O.absent}),Object.defineProperty(this,"body",{enumerable:!0,value:r||O.empty()})}function d(e,t){p.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e}),Object.defineProperty(this,"lane",{enumerable:!0,value:t})}function h(e,t){u.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e}),Object.defineProperty(this,"lane",{enumerable:!0,value:t})}function y(e,t){p.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e}),Object.defineProperty(this,"lane",{enumerable:!0,value:t})}function v(e,t){u.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e}),Object.defineProperty(this,"lane",{enumerable:!0,value:t})}function m(e,t){p.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e}),Object.defineProperty(this,"lane",{enumerable:!0,value:t})}function b(e,t){u.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e}),Object.defineProperty(this,"lane",{enumerable:!0,value:t})}function E(e){p.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e})}function w(e,t){p.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e}),Object.defineProperty(this,"body",{enumerable:!0,value:t||O.empty()})}function g(e,t){u.call(this),Object.defineProperty(this,"node",{enumerable:!0,value:e}),Object.defineProperty(this,"body",{enumerable:!0,value:t||O.empty()})}var O=e("recon-js");Object.defineProperty(a.prototype,"isRequest",{value:!1}),Object.defineProperty(a.prototype,"isResponse",{value:!1}),Object.defineProperty(a.prototype,"isMessage",{value:!1}),Object.defineProperty(a.prototype,"isEventMessage",{value:!1}),Object.defineProperty(a.prototype,"isCommandMessage",{value:!1}),Object.defineProperty(a.prototype,"isSyncRequest",{value:!1}),Object.defineProperty(a.prototype,"isSyncedResponse",{value:!1}),Object.defineProperty(a.prototype,"isLinkRequest",{value:!1}),Object.defineProperty(a.prototype,"isLinkedResponse",{value:!1}),Object.defineProperty(a.prototype,"isUnlinkRequest",{value:!1}),Object.defineProperty(a.prototype,"isUnlinkedResponse",{value:!1}),Object.defineProperty(a.prototype,"isGetRequest",{value:!1}),Object.defineProperty(a.prototype,"isPutRequest",{value:!1}),Object.defineProperty(a.prototype,"isStateResponse",{value:!1}),p.prototype=Object.create(a.prototype),p.prototype.constructor=p,Object.defineProperty(p.prototype,"isRequest",{value:!0}),u.prototype=Object.create(a.prototype),u.prototype.constructor=u,Object.defineProperty(p.prototype,"isResponse",{value:!0}),l.prototype=Object.create(a.prototype),l.prototype.constructor=l,Object.defineProperty(p.prototype,"isMessage",{value:!0}),c.prototype=Object.create(l.prototype),c.prototype.constructor=c,Object.defineProperty(c.prototype,"isEventMessage",{value:!0}),c.prototype.encode=function(){var e=O.builder(),t=O.builder();return t.slot("node",this.node),t.slot("lane",this.lane),this.via.isAbsent||t.slot("via",this.via),e.attr("event",t.state()),e.appendRecord(this.body),e.state()},c.decode=function(e){var t="",n="",r=O.absent,i=e.tail(),o=e.head();if(o.value.isRecord)for(var s=o.value.iterator(),a=0;!s.isEmpty();){var p=s.next();if(p.isField)switch(p.key){case"node":t=p.value;break;case"lane":n=p.value;break;case"via":r=p.value}else switch(a){case 0:t=p;break;case 1:n=p;break;case 2:r=p}a+=1}return new c(t,n,r,i)},f.prototype=Object.create(l.prototype),f.prototype.constructor=f,Object.defineProperty(f.prototype,"isCommandMessage",{value:!0}),f.prototype.encode=function(){var e=O.builder(),t=O.builder();return t.slot("node",this.node),t.slot("lane",this.lane),this.via.isAbsent||t.slot("via",this.via),e.attr("command",t.state()),e.appendRecord(this.body),e.state()},f.decode=function(e){var t="",n="",r=O.absent,i=e.tail(),o=e.head();if(o.value.isRecord)for(var s=o.value.iterator(),a=0;!s.isEmpty();){var p=s.next();if(p.isField)switch(p.key){case"node":t=p.value;break;case"lane":n=p.value;break;case"via":r=p.value}else switch(a){case 0:t=p;break;case 1:n=p;break;case 2:r=p}a+=1}return new f(t,n,r,i)},d.prototype=Object.create(p.prototype),d.prototype.constructor=d,Object.defineProperty(d.prototype,"isSyncRequest",{value:!0}),d.prototype.encode=function(){return O(O.attr("sync",O(O.slot("node",this.node),O.slot("lane",this.lane))))},d.decode=function(e){var t="",n="",r=e.head();if(r.value.isRecord)for(var i=r.value.iterator(),o=0;!i.isEmpty();){var s=i.next();if(s.isField)switch(s.key){case"node":t=s.value;break;case"lane":n=s.value}else switch(o){case 0:t=s;break;case 1:n=s}o+=1}return new d(t,n)},h.prototype=Object.create(u.prototype),h.prototype.constructor=h,Object.defineProperty(h.prototype,"isSyncedResponse",{value:!0}),h.prototype.encode=function(){return O(O.attr("synced",O(O.slot("node",this.node),O.slot("lane",this.lane))))},h.decode=function(e){var t="",n="",r=e.head();if(r.value.isRecord)for(var i=r.value.iterator(),o=0;!i.isEmpty();){var s=i.next();if(s.isField)switch(s.key){case"node":t=s.value;break;case"lane":n=s.value}else switch(o){case 0:t=s;break;case 1:n=s}o+=1}return new h(t,n)},y.prototype=Object.create(p.prototype),y.prototype.constructor=y,Object.defineProperty(y.prototype,"isLinkRequest",{value:!0}),y.prototype.encode=function(){return O(O.attr("link",O(O.slot("node",this.node),O.slot("lane",this.lane))))},y.decode=function(e){var t="",n="",r=e.head();if(r.value.isRecord)for(var i=r.value.iterator(),o=0;!i.isEmpty();){var s=i.next();if(s.isField)switch(s.key){case"node":t=s.value;break;case"lane":n=s.value}else switch(o){case 0:t=s;break;case 1:n=s}o+=1}return new y(t,n)},v.prototype=Object.create(u.prototype),v.prototype.constructor=v,Object.defineProperty(v.prototype,"isLinkedResponse",{value:!0}),v.prototype.encode=function(){return O(O.attr("linked",O(O.slot("node",this.node),O.slot("lane",this.lane))))},v.decode=function(e){var t="",n="",r=e.head();if(r.value.isRecord)for(var i=r.value.iterator(),o=0;!i.isEmpty();){var s=i.next();if(s.isField)switch(s.key){case"node":t=s.value;break;case"lane":n=s.value}else switch(o){case 0:t=s;break;case 1:n=s}o+=1}return new v(t,n)},m.prototype=Object.create(p.prototype),m.prototype.constructor=m,Object.defineProperty(m.prototype,"isUnlinkRequest",{value:!0}),m.prototype.encode=function(){return O(O.attr("unlink",O(O.slot("node",this.node),O.slot("lane",this.lane))))},m.decode=function(e){var t="",n="",r=e.head();if(r.value.isRecord)for(var i=r.value.iterator(),o=0;!i.isEmpty();){var s=i.next();if(s.isField)switch(s.key){case"node":t=s.value;break;case"lane":n=s.value}else switch(o){case 0:t=s;break;case 1:n=s}o+=1}return new m(t,n)},b.prototype=Object.create(u.prototype),b.prototype.constructor=b,Object.defineProperty(b.prototype,"isUnlinkedResponse",{value:!0}),b.prototype.encode=function(){return O(O.attr("unlinked",O(O.slot("node",this.node),O.slot("lane",this.lane))))},b.decode=function(e){var t="",n="",r=e.head();if(r.value.isRecord)for(var i=r.value.iterator(),o=0;!i.isEmpty();){var s=i.next();if(s.isField)switch(s.key){case"node":t=s.value;break;case"lane":n=s.value}else switch(o){case 0:t=s;break;case 1:n=s}o+=1}return new b(t,n)},E.prototype=Object.create(p.prototype),E.prototype.constructor=E,Object.defineProperty(E.prototype,"isGetRequest",{value:!0}),E.prototype.encode=function(){return O(O.attr("get",O(O.slot("node",this.node))))},E.decode=function(e){var t="",n=e.head();if(n.value.isRecord)for(var r=n.value.iterator(),i=0;!r.isEmpty();){var o=r.next();if(o.isField)switch(o.key){case"node":t=o.value}else switch(i){case 0:t=o}i+=1}else n.value.isExtant||(t=n.value);return new E(t)},w.prototype=Object.create(p.prototype),w.prototype.constructor=w,Object.defineProperty(w.prototype,"isPutRequest",{value:!0}),w.prototype.encode=function(){var e=O.builder();return e.attr("put",O(O.slot("node",this.node))),e.appendRecord(this.body),e.state()},w.decode=function(e){var t="",n=e.tail(),r=e.head();if(r.value.isRecord)for(var i=r.value.iterator(),o=0;!i.isEmpty();){var s=i.next();if(s.isField)switch(s.key){case"node":t=s.value}else switch(o){case 0:t=s}o+=1}else r.value.isExtant||(t=r.value);return new w(t,n)},g.prototype=Object.create(u.prototype),g.prototype.constructor=g,Object.defineProperty(g.prototype,"isStateResponse",{value:!0}),g.prototype.encode=function(){var e=O.builder();return e.attr("state",O(O.slot("node",this.node))),e.appendRecord(this.body),e.state()},g.decode=function(e){var t="",n=e.tail(),r=e.head();if(r.value.isRecord)for(var i=r.value.iterator(),o=0;!i.isEmpty();){var s=i.next();if(s.isField)switch(s.key){case"node":t=s.value}else switch(o){case 0:t=s}o+=1}else r.value.isExtant||(t=r.value);return new g(t,n)},n.decode=r,n.encode=i,n.parse=o,n.stringify=s,n.Envelope=a,n.RequestEnvelope=p,n.ResponseEnvelope=u,n.MessageEnvelope=l,n.EventMessage=c,n.CommandMessage=f,n.SyncRequest=d,n.SyncedResponse=h,n.LinkRequest=y,n.LinkedResponse=v,n.UnlinkRequest=m,n.UnlinkedResponse=b,n.GetRequest=E,n.PutRequest=w,n.StateResponse=g},{"recon-js":1}],3:[function(e,t,n){var r=function(){function e(e){throw new RangeError(C[e])}function t(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function n(e,n){var r=e.split("@"),i="";r.length>1&&(i=r[0]+"@",e=r[1]),e=e.replace(k,".");var o=e.split("."),s=t(o,n).join(".");return i+s}function r(e){for(var t,n,r=[],i=0,o=e.length;o>i;)t=e.charCodeAt(i++),t>=55296&&56319>=t&&o>i?(n=e.charCodeAt(i++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--)):r.push(t);return r}function i(e){return t(e,function(e){var t="";return e>65535&&(e-=65536,t+=R(e>>>10&1023|55296),e=56320|1023&e),t+=R(e)}).join("")}function o(e){return 10>e-48?e-22:26>e-65?e-65:26>e-97?e-97:h}function s(e,t){return e+22+75*(26>e)-((0!=t)<<5)}function a(e,t,n){var r=0;for(e=n?j(e/b):e>>1,e+=j(e/t);e>x*v>>1;r+=h)e=j(e/x);return j(r+(x+1)*e/(e+m))}function p(t){var n,r,s,p,u,l,c,f,m,b,O=[],D=t.length,k=0,C=w,x=E;for(r=t.lastIndexOf(g),0>r&&(r=0),s=0;r>s;++s)t.charCodeAt(s)>=128&&e("not-basic"),O.push(t.charCodeAt(s));for(p=r>0?r+1:0;D>p;){for(u=k,l=1,c=h;p>=D&&e("invalid-input"),f=o(t.charCodeAt(p++)),(f>=h||f>j((d-k)/l))&&e("overflow"),k+=f*l,m=x>=c?y:c>=x+v?v:c-x,!(m>f);c+=h)b=h-m,l>j(d/b)&&e("overflow"),l*=b;n=O.length+1,x=a(k-u,n,0==u),j(k/n)>d-C&&e("overflow"),C+=j(k/n),k%=n,O.splice(k++,0,C)}return i(O)}function u(t){var n,i,o,p,u,l,c,f,m,b,O,D,k,C,x,P=[];for(t=r(t),D=t.length,n=w,i=0,u=E,l=0;D>l;++l)O=t[l],128>O&&P.push(R(O));for(o=p=P.length,p&&P.push(g);D>o;){for(c=d,l=0;D>l;++l)O=t[l],O>=n&&c>O&&(c=O);for(k=o+1,c-n>j((d-i)/k)&&e("overflow"),i+=(c-n)*k,n=c,l=0;D>l;++l)if(O=t[l],n>O&&++i>d&&e("overflow"),O==n){for(f=i,m=h;b=u>=m?y:m>=u+v?v:m-u,!(b>f);m+=h)x=f-b,C=h-b,P.push(R(s(b+x%C,0))),f=j(x/C);P.push(R(s(f,0))),u=a(i,k,o==p),i=0,++o}++i,++n}return P.join("")}function l(e){return n(e,function(e){return O.test(e)?p(e.slice(4).toLowerCase()):e})}function c(e){return n(e,function(e){return D.test(e)?"xn--"+u(e):e})}var f,d=2147483647,h=36,y=1,v=26,m=38,b=700,E=72,w=128,g="-",O=/^xn--/,D=/[^\x20-\x7E]/,k=/[\x2E\u3002\uFF0E\uFF61]/g,C={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},x=h-y,j=Math.floor,R=String.fromCharCode;return f={version:"1.3.2",ucs2:{decode:r,encode:i},decode:p,encode:u,toASCII:c,toUnicode:l}}();"undefined"==typeof COMPILED&&"undefined"!=typeof t&&(t.exports=r)},{}],4:[function(e,t,n){e("./schemes/http"),e("./schemes/urn"),e("./schemes/mailto")},{"./schemes/http":5,"./schemes/mailto":6,"./schemes/urn":7}],5:[function(e,t,n){if("undefined"==typeof COMPILED&&"undefined"==typeof r&&"function"==typeof e)var r=e("../uri");r.SCHEMES.http=r.SCHEMES.https={domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){return(e.port===("https"!==String(e.scheme).toLowerCase()?80:443)||""===e.port)&&(e.port=void 0),e.path||(e.path="/"),e}}},{"../uri":8}],6:[function(e,t,n){if("undefined"==typeof COMPILED&&"undefined"==typeof r&&"function"==typeof e)var r=e("../uri"),i=e("../punycode");!function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];if(e.length>1){e[0]=e[0].slice(0,-1);for(var n=e.length-1,r=1;n>r;++r)e[r]=e[r].slice(1,-1);return e[n]=e[n].slice(1),e.join("")}return e[0]}function t(e){return"(?:"+e+")"}function n(e){return e.toUpperCase()}function o(e){var t=r.pctDecChars(e);return t.match(F)?t:e}function s(e){return void 0!==e&&null!==e?e instanceof Array&&!e.callee?e:"number"!=typeof e.length||e.split||e.setInterval||e.call?[e]:Array.prototype.slice.call(e):[]}var a={},p=r.IRI_SUPPORT,u="[A-Za-z0-9\\-\\.\\_\\~"+(p?"\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF":"")+"]",l="[0-9A-Fa-f]",c=t(t("%[EFef]"+l+"%"+l+l+"%"+l+l)+"|"+t("%[89A-Fa-f]"+l+"%"+l+l)+"|"+t("%"+l+l)),f="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",d="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",h=e(d,'[\\"\\\\]'),y=t(f+"+"+t("\\."+f+"+")+"*"),v=t("\\\\"+h),m=t(d+"|"+v),b=t('\\"'+m+'*\\"'),E="[\\x21-\\x5A\\x5E-\\x7E]",w="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",g=t(u+"|"+c+"|"+w),O=t(y+"|\\["+E+"*\\]"),D=t(y+"|"+b),k=t(D+"\\@"+O),C=t(k+t("\\,"+k)+"*"),x=t(g+"*"),j=x,R=t(x+"\\="+j),P=t(R+t("\\&"+R)+"*"),S=t("\\?"+P),F=(r.VALIDATE_SUPPORT&&new RegExp("^mailto\\:"+C+"?"+S+"?$"),new RegExp(u,"g")),_=new RegExp(c,"g"),A=new RegExp(e("[^]",f,"[\\.]",'[\\"]',h),"g"),q=new RegExp(e("[^]",f,"[\\.]","[\\[]",E,"[\\]]"),"g"),T=new RegExp(e("[^]",u,w),"g"),I=T,N=r.VALIDATE_SUPPORT&&new RegExp("^"+C+"$"),U=r.VALIDATE_SUPPORT&&new RegExp("^"+P+"$");r.SCHEMES.mailto={parse:function(e,t){r.VALIDATE_SUPPORT&&!e.error&&(e.path&&!N.test(e.path)?e.error="Email address is not valid":e.query&&!U.test(e.query)&&(e.error="Header fields are invalid"));var n=e.to=e.path?e.path.split(","):[];if(e.path=void 0,e.query){for(var o=!1,s={},a=e.query.split("&"),p=0,u=a.length;u>p;++p){var l=a[p].split("=");switch(l[0]){case"to":for(var c=l[1].split(","),f=0,d=c.length;d>f;++f)n.push(c[f]);break;case"subject":e.subject=r.unescapeComponent(l[1],t);break;case"body":e.body=r.unescapeComponent(l[1],t);break;default:o=!0,s[r.unescapeComponent(l[0],t)]=r.unescapeComponent(l[1],t)}}o&&(e.headers=s)}e.query=void 0;for(var p=0,u=n.length;u>p;++p){var h=n[p].split("@");if(h[0]=r.unescapeComponent(h[0]),"undefined"==typeof i||t.unicodeSupport)h[1]=r.unescapeComponent(h[1],t).toLowerCase();else try{h[1]=i.toASCII(r.unescapeComponent(h[1],t).toLowerCase())}catch(y){e.error=e.error||"Email address's domain name can not be converted to ASCII via punycode: "+y}n[p]=h.join("@")}return e},serialize:function(e,t){var p=s(e.to);if(p){for(var u=0,l=p.length;l>u;++u){var c=String(p[u]),f=c.lastIndexOf("@"),d=c.slice(0,f),h=c.slice(f+1);if(d=d.replace(_,o).replace(_,n).replace(A,r.pctEncChar),"undefined"!=typeof i)try{h=t.iri?i.toUnicode(h):i.toASCII(r.unescapeComponent(h,t).toLowerCase())}catch(y){e.error=e.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+y}else h=h.replace(_,o).toLowerCase().replace(_,n).replace(q,r.pctEncChar);p[u]=d+"@"+h}e.path=p.join(",")}var v=e.headers=e.headers||{};e.subject&&(v.subject=e.subject),e.body&&(v.body=e.body);var m=[];for(var b in v)v[b]!==a[b]&&m.push(b.replace(_,o).replace(_,n).replace(T,r.pctEncChar)+"="+v[b].replace(_,o).replace(_,n).replace(I,r.pctEncChar));return m.length&&(e.query=m.join("&")),e}}}()},{"../punycode":3,"../uri":8}],7:[function(e,t,n){if("undefined"==typeof COMPILED&&"undefined"==typeof r&&"function"==typeof e)var r=e("../uri");!function(){var e=r.pctEncChar,t="(?:[0-9A-Za-z][0-9A-Za-z\\-]{1,31})",n="(?:\\%[0-9A-Fa-f]{2})",i="[0-9A-Za-z\\(\\)\\+\\,\\-\\.\\:\\=\\@\\;\\$\\_\\!\\*\\'\\/\\?\\#]",o="(?:(?:"+n+"|"+i+")+)",s=new RegExp("^urn\\:("+t+")$"),a=new RegExp("^("+t+")\\:("+o+")$"),p=/^([^\:]+)\:(.*)/,u=/[\x00-\x20\\\"\&\<\>\[\]\^\`\{\|\}\~\x7F-\xFF]/g,l=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/;r.SCHEMES.urn={parse:function(e,t){var n,i,o=e.path.match(a);return o||(t.tolerant||(e.error=e.error||"URN is not strictly valid."),o=e.path.match(p)),o?(n="urn:"+o[1].toLowerCase(),i=r.SCHEMES[n],i||(i=r.SCHEMES[n]={parse:function(e,t){return e},serialize:r.SCHEMES.urn.serialize}),e.scheme=n,e.path=o[2],e=i.parse(e,t)):e.error=e.error||"URN can not be parsed.",e},serialize:function(t,n){var r,i=t.scheme||n.scheme;if(i&&"urn"!==i){var r=i.match(s);r||(r=["urn:"+i,i]),t.scheme="urn",t.path=r[1]+":"+(t.path?t.path.replace(u,e):"")}return t}},r.SCHEMES["urn:uuid"]={parse:function(e,t){return t.tolerant||e.path&&e.path.match(l)||(e.error=e.error||"UUID is not valid."),e},serialize:function(e,t){return t.tolerant||e.path&&e.path.match(l)?e.path=(e.path||"").toLowerCase():e.scheme=void 0,r.SCHEMES.urn.serialize(e,t)}}}()},{"../uri":8}],8:[function(e,t,n){var r=!1,i=!0,o=!0,s=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];if(e.length>1){e[0]=e[0].slice(0,-1);for(var n=e.length-1,r=1;n>r;++r)e[r]=e[r].slice(1,-1);return e[n]=e[n].slice(1),e.join("")}return e[0]}function t(e){return"(?:"+e+")"}function n(n){var r="[A-Za-z]",i="[0-9]",s=e(i,"[A-Fa-f]"),a=t(t("%[EFef]"+s+"%"+s+s+"%"+s+s)+"|"+t("%[89A-Fa-f]"+s+"%"+s+s)+"|"+t("%"+s+s)),p="[\\:\\/\\?\\#\\[\\]\\@]",u="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",l=e(p,u),c=n?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",f=n?"[\\uE000-\\uF8FF]":"[]",d=e(r,i,"[\\-\\.\\_\\~]",c),h=t(r+e(r,i,"[\\+\\-\\.]")+"*"),y=t(t(a+"|"+e(d,u,"[\\:]"))+"*"),v=t(t("25[0-5]")+"|"+t("2[0-4]"+i)+"|"+t("1"+i+i)+"|"+t("[1-9]"+i)+"|"+i),m=t(v+"\\."+v+"\\."+v+"\\."+v),b=t(s+"{1,4}"),E=(t(t(b+"\\:"+b)+"|"+m),t(e(d,u,"[\\:]")+"+")),w=t("v"+s+"+\\."+e(d,u,"[\\:]")+"+"),g=t("\\["+t(E+"|"+w)+"\\]"),O=t(t(a+"|"+e(d,u))+"*"),D=t(g+"|"+m+"(?!"+O+")|"+O),k=t(i+"*"),C=t(t(y+"@")+"?"+D+t("\\:"+k)+"?"),x=t(a+"|"+e(d,u,"[\\:\\@]")),j=t(x+"*"),R=t(x+"+"),P=t(t(a+"|"+e(d,u,"[\\@]"))+"+"),S=t(t("\\/"+j)+"*"),F=t("\\/"+t(R+S)+"?"),_=t(P+S),A=t(R+S),q="(?!"+x+")",T=(t(S+"|"+F+"|"+_+"|"+A+"|"+q),t(t(x+"|"+e("[\\/\\?]",f))+"*")),I=t(t(x+"|[\\/\\?]")+"*"),N=t(t("\\/\\/"+C+S)+"|"+F+"|"+A+"|"+q),U=t(h+"\\:"+N+t("\\?"+T)+"?"+t("\\#"+I)+"?"),H=t(t("\\/\\/"+C+S)+"|"+F+"|"+_+"|"+q),M=t(H+t("\\?"+T)+"?"+t("\\#"+I)+"?"),L=(t(U+"|"+M),t(h+"\\:"+N+t("\\?"+T)+"?"),"^("+h+")\\:"+t(t("\\/\\/("+t("("+y+")@")+"?("+D+")"+t("\\:("+k+")")+"?)")+"?("+S+"|"+F+"|"+A+"|"+q+")")+t("\\?("+T+")")+"?"+t("\\#("+I+")")+"?$"),B="^(){0}"+t(t("\\/\\/("+t("("+y+")@")+"?("+D+")"+t("\\:("+k+")")+"?)")+"?("+S+"|"+F+"|"+_+"|"+q+")")+t("\\?("+T+")")+"?"+t("\\#("+I+")")+"?$";"^("+h+")\\:"+t(t("\\/\\/("+t("("+y+")@")+"?("+D+")"+t("\\:("+k+")")+"?)")+"?("+S+"|"+F+"|"+A+"|"+q+")")+t("\\?("+T+")")+"?$","^"+t("\\#("+I+")")+"?$","^"+t("("+y+")@")+"?("+D+")"+t("\\:("+k+")")+"?$";return{URI_REF:o&&new RegExp("("+L+")|("+B+")"),NOT_SCHEME:new RegExp(e("[^]",r,i,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(e("[^\\%\\:]",d,u),"g"),NOT_HOST:new RegExp(e("[^\\%]",d,u),"g"),NOT_PATH:new RegExp(e("[^\\%\\/\\:\\@]",d,u),"g"),NOT_PATH_NOSCHEME:new RegExp(e("[^\\%\\/\\@]",d,u),"g"),NOT_QUERY:new RegExp(e("[^\\%]",d,u,"[\\:\\@\\/\\?]",f),"g"),NOT_FRAGMENT:new RegExp(e("[^\\%]",d,u,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(e("[^]",d,u),"g"),UNRESERVED:new RegExp(d,"g"),OTHER_CHARS:new RegExp(e("[^\\%]",d,l),"g"),PCT_ENCODED:new RegExp(a,"g")}}function r(e){var t,n=e.charCodeAt(0);return t=16>n?"%0"+n.toString(16).toUpperCase():128>n?"%"+n.toString(16).toUpperCase():2048>n?"%"+(n>>6|192).toString(16).toUpperCase()+"%"+(63&n|128).toString(16).toUpperCase():"%"+(n>>12|224).toString(16).toUpperCase()+"%"+(n>>6&63|128).toString(16).toUpperCase()+"%"+(63&n|128).toString(16).toUpperCase()}function s(e){for(var t,n,r,i="",o=0,s=e.length;s>o;)t=parseInt(e.substr(o+1,2),16),128>t?(i+=String.fromCharCode(t),o+=3):t>=194&&224>t?(s-o>=6?(n=parseInt(e.substr(o+4,2),16),i+=String.fromCharCode((31&t)<<6|63&n)):i+=e.substr(o,6),o+=6):t>=224?(s-o>=9?(n=parseInt(e.substr(o+4,2),16),r=parseInt(e.substr(o+7,2),16),i+=String.fromCharCode((15&t)<<12|(63&n)<<6|63&r)):i+=e.substr(o,9),o+=9):(i+=e.substr(o,3),o+=3);return i}function p(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function u(e){return e.toUpperCase()}function l(e,t){function n(e){var n=s(e);return n.match(t.UNRESERVED)?n:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,n).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,n).replace(t.NOT_USERINFO,r).replace(t.PCT_ENCODED,u)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,n).toLowerCase().replace(t.NOT_HOST,r).replace(t.PCT_ENCODED,u)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,n).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,r).replace(t.PCT_ENCODED,u)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,n).replace(t.NOT_QUERY,r).replace(t.PCT_ENCODED,u)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,n).replace(t.NOT_FRAGMENT,r).replace(t.PCT_ENCODED,u)),e}function c(e,t){void 0===t&&(t={});var n,r,p=i&&t.iri!==!1?O:g,u=!1,c={};if("suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e),o?(n=e.match(p.URI_REF),n&&(n=n[1]?n.slice(1,10):n.slice(10,19)),n||(u=!0,t.tolerant||(c.error=c.error||"URI is not strictly valid."),n=e.match(D))):n=e.match(D),n){if(R?(c.scheme=n[1],c.userinfo=n[3],c.host=n[4],c.port=parseInt(n[5],10),c.path=n[6]||"",c.query=n[7],c.fragment=n[8],isNaN(c.port)&&(c.port=n[5])):(c.scheme=n[1]||void 0,c.userinfo=-1!==e.indexOf("@")?n[3]:void 0,c.host=-1!==e.indexOf("//")?n[4]:void 0,c.port=parseInt(n[5],10),c.path=n[6]||"",c.query=-1!==e.indexOf("?")?n[7]:void 0,c.fragment=-1!==e.indexOf("#")?n[8]:void 0,isNaN(c.port)&&(c.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?n[4]:void 0)),void 0!==c.scheme||void 0!==c.userinfo||void 0!==c.host||void 0!==c.port||c.path||void 0!==c.query?void 0===c.scheme?c.reference="relative":void 0===c.fragment?c.reference="absolute":c.reference="uri":c.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==c.reference&&(c.error=c.error||"URI is not a "+t.reference+" reference."),r=P[(t.scheme||c.scheme||"").toLowerCase()],!i||"undefined"==typeof a||t.unicodeSupport||r&&r.unicodeSupport)l(c,p);else{if(c.host&&(t.domainHost||r&&r.domainHost))try{c.host=a.toASCII(c.host.replace(p.PCT_ENCODED,s).toLowerCase())}catch(f){c.error=c.error||"Host's domain name can not be converted to ASCII via punycode: "+f}l(c,g)}r&&r.parse&&r.parse(c,t)}else u=!0,c.error=c.error||"URI can not be parsed.";return c}function f(e,t){var n=[];return void 0!==e.userinfo&&(n.push(e.userinfo),n.push("@")),void 0!==e.host&&n.push(e.host),"number"==typeof e.port&&(n.push(":"),n.push(e.port.toString(10))),n.length?n.join(""):void 0}function d(e){for(var t,n=[];e.length;)e.match(k)?e=e.replace(k,""):e.match(C)?e=e.replace(C,"/"):e.match(x)?(e=e.replace(x,"/"),n.pop()):"."===e||".."===e?e="":(t=e.match(j)[0],e=e.slice(t.length),n.push(t));return n.join("")}function h(e,t){void 0===t&&(t={});var n,r,o,p=i&&t.iri?O:g,u=[];if(n=P[(t.scheme||e.scheme||"").toLowerCase()],n&&n.serialize&&n.serialize(e,t),i&&"undefined"!=typeof a&&e.host&&(t.domainHost||n&&n.domainHost))try{e.host=t.iri?a.toUnicode(e.host):a.toASCII(e.host.replace(p.PCT_ENCODED,s).toLowerCase())}catch(c){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+c}return l(e,p),"suffix"!==t.reference&&e.scheme&&(u.push(e.scheme),u.push(":")),r=f(e,t),void 0!==r&&("suffix"!==t.reference&&u.push("//"),u.push(r),e.path&&"/"!==e.path.charAt(0)&&u.push("/")),void 0!==e.path&&(o=e.path,t.absolutePath||n&&n.absolutePath||(o=d(o)),void 0===r&&(o=o.replace(/^\/\//,"/%2F")),u.push(o)),void 0!==e.query&&(u.push("?"),u.push(e.query)),void 0!==e.fragment&&(u.push("#"),u.push(e.fragment)),u.join("")}function y(e,t,n,r){void 0===n&&(n={});var i={};return r||(e=c(h(e,n),n),t=c(h(t,n),n)),n=n||{},!n.tolerant&&t.scheme?(i.scheme=t.scheme,i.userinfo=t.userinfo,i.host=t.host,i.port=t.port,i.path=d(t.path),i.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(i.userinfo=t.userinfo,i.host=t.host,i.port=t.port,i.path=d(t.path),i.query=t.query):(t.path?("/"===t.path.charAt(0)?i.path=d(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?i.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:i.path=t.path:i.path="/"+t.path,i.path=d(i.path)),i.query=t.query):(i.path=e.path,void 0!==t.query?i.query=t.query:i.query=e.query),i.userinfo=e.userinfo,i.host=e.host,i.port=e.port),i.scheme=e.scheme),i.fragment=t.fragment,i}function v(e,t,n){return h(y(c(e,n),c(t,n),n,!0),n)}function m(e,t){return"string"==typeof e?e=h(c(e,t),t):"object"===p(e)&&(e=c(h(e,t),t)),e}function b(e,t,n){return"string"==typeof e?e=h(c(e,n),n):"object"===p(e)&&(e=h(e,n)),"string"==typeof t?t=h(c(t,n),n):"object"===p(t)&&(t=h(t,n)),e===t}function E(e,t){return e&&e.toString().replace(i&&t&&t.iri?O.ESCAPE:g.ESCAPE,r)}function w(e,t){return e&&e.toString().replace(i&&t&&t.iri?O.PCT_ENCODED:g.PCT_ENCODED,s)}var g=n(!1),O=i?n(!0):void 0,D=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?([^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n)*))?/i,k=/^\.\.?\//,C=/^\/\.(\/|$)/,x=/^\/\.\.(\/|$)/,j=/^\/?(?:.|\n)*?(?=\/|$)/,R=void 0==="".match(/(){0}/)[1],P={};return{IRI_SUPPORT:i,VALIDATE_SUPPORT:o,pctEncChar:r,pctDecChars:s,SCHEMES:P,parse:c,_recomposeAuthority:f,removeDotSegments:d,serialize:h,resolveComponents:y,resolve:v,normalize:m,equal:b,escapeComponent:E,unescapeComponent:w}}();if(!r&&"undefined"!=typeof t&&"function"==typeof e){var a=e("./punycode");t.exports=s,e("./schemes")}},{"./punycode":3,"./schemes":4}],9:[function(e,t,n){function r(e,t){var n;return n=t?new o(e,t):new o(e)}var i=function(){return this}(),o=i.WebSocket||i.MozWebSocket;t.exports={w3cwebsocket:o?r:null,version:e("./version")}},{"./version":10}],10:[function(e,t,n){t.exports=e("../package.json").version},{"../package.json":11}],11:[function(e,t,n){t.exports={name:"websocket",description:"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",keywords:["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],author:{name:"Brian McKelvey",email:"brian@worlize.com",url:"https://www.worlize.com/"},contributors:[{name:"Iñaki Baz Castillo",email:"ibc@aliax.net",url:"http://dev.sipdoc.net"}],version:"1.0.21",repository:{type:"git",url:"git+https://github.com/theturtle32/WebSocket-Node.git"},homepage:"https://github.com/theturtle32/WebSocket-Node",engines:{node:">=0.8.0"},dependencies:{debug:"~2.2.0",nan:"~1.8.x","typedarray-to-buffer":"~3.0.3",yaeti:"~0.0.4"},devDependencies:{"buffer-equal":"^0.0.1",faucet:"^0.0.1",gulp:"git+https://github.com/gulpjs/gulp.git#4.0","gulp-jshint":"^1.11.2","jshint-stylish":"^1.0.2",tape:"^4.0.1"},config:{verbose:!1},scripts:{install:"(node-gyp rebuild 2> builderror.log) || (exit 0)",test:"faucet test/unit",gulp:"gulp"},main:"index",directories:{lib:"./lib"},browser:"lib/browser.js",license:"Apache-2.0",gitHead:"8f5d5f3ef3d946324fe016d525893546ff6500e1",bugs:{url:"https://github.com/theturtle32/WebSocket-Node/issues"},_id:"websocket@1.0.21",_shasum:"f51f0a96ed19629af39922470ab591907f1c5bd9",_from:"websocket@>=1.0.21 <2.0.0",_npmVersion:"2.12.1",_nodeVersion:"2.3.4",_npmUser:{name:"theturtle32",email:"brian@worlize.com"},maintainers:[{name:"theturtle32",email:"brian@worlize.com"}],dist:{shasum:"f51f0a96ed19629af39922470ab591907f1c5bd9",tarball:"https://repo.webaware.com/sinopia/websocket/-/websocket-1.0.21.tgz"},_resolved:"https://repo.webaware.com/sinopia/websocket/-/websocket-1.0.21.tgz",readme:"ERROR: No README data found!"}},{}],12:[function(e,t,n){"use strict";function r(){}function i(e,t){d.auth(e,t)}function o(e,t,n){d.get(e).sync(e,t,n)}function s(e,t,n){d.get(e).link(e,t,n)}function a(e,t,n){d.get(e).unlink(e,t,n)}function p(e,t,n){d.get(e).sendEvent(e,t,n)}function u(e,t,n){d.get(e).sendCommand(e,t,n)}function l(e,t){d.get(e).get(e,t)}function c(e,t,n){d.get(e).put(e,t,n)}function f(){for(var e in d.bridge){var t=d.bridge[e];t.sendBuffer=[],t.unlinkAll(),t.close()}d.bridge={}}function d(e,t){d.bridge[e]=this,this.node=e,this.query=t,this.linkCount=0,this.linkHandles={},this.stateHandles={},this.sendBuffer=[],this.reconnectTimeout=null,this.reconnectTime=250+Math.round(750*Math.random()),this.closed=!1,this.open()}var h=e("swim-proto-js"),y=e("uri-js"),v=e("websocket").w3cwebsocket,m={SEND_BUFFER_SIZE:1024,MAX_RECONNECT_TIME:15e3},b=-2,E=-1,w=0,g=1;d.prototype.open=function(){var e=this.node;this.query&&(e=e+"?"+this.query),this.socket=new v(e,"swim-0.0"),this.socket.onopen=this.onOpen.bind(this),this.socket.onclose=this.onClose.bind(this),this.socket.onmessage=this.onFrame.bind(this),this.socket.onerror=this.onError.bind(this)},d.prototype.close=function(){this.closed=!0,this.socket.close()},d.prototype.send=function(e){this.socket.readyState!==this.socket.OPEN?this.buffer(e):this.socket.send(h.stringify(e))},d.prototype.buffer=function(e){e.isSyncRequest||e.isLinkRequest||e.isUnlinkRequest||this.sendBuffer.length>m.SEND_BUFFER_SIZE||this.sendBuffer.push(e)},d.prototype.onOpen=function(){clearTimeout(this.reconnectTimeout),this.reconnectTime=250+Math.round(750*Math.random());var e;for(var t in this.linkHandles){var n=this.linkHandles[t];for(var r in n){for(var i=n[r],o=!1,s=0,a=i.length;!o&&a>s;s+=1){var p=i[s],u=p.__swim_link_state__;o=o||u.synced}e=o?new h.SyncRequest(this.unresolve(t),r):new h.LinkRequest(this.unresolve(t),r),this.send(e)}}for(;e=this.sendBuffer.shift();)this.send(e)},d.prototype.onClose=function(){if(0===this.linkCount&&0===this.sendBuffer.length)return void delete d.bridge[this.node];for(var e in this.linkHandles){var t=this.linkHandles[e];for(var n in t)for(var r=t[n],i=0,o=r.length;o>i;i+=1){var s=r[i],a=s.__swim_link_state__;a.status===g&&("function"==typeof s.onBroken&&s.onBroken.call(s,e,n),a.status=E)}}this.closed||(this.reconnectTimeout=setTimeout(this.open.bind(this),this.reconnectTime),this.reconnectTime=Math.min(2*this.reconnectTime,m.MAX_RECONNECT_TIME))},d.prototype.onError=function(){this.socket.readyState===this.socket.OPEN&&this.socket.close()},d.prototype.onFrame=function(e){var t=e.data;if("string"==typeof t){var n=h.parse(t);n&&this.onReceive(n)}},d.prototype.initHandle=function(e,t){"function"==typeof e&&(e={onEvent:e,onCommand:e});var n={status:w,synced:t};return Object.defineProperty(e,"__swim_link_state__",{value:n,configurable:!0}),e},d.prototype.registerHandle=function(e,t,n){var r=!1,i=this.linkHandles[e];void 0===i&&(i={},this.linkHandles[e]=i);var o=i[t];return void 0===o&&(r=!0,o=[],i[t]=o),o.push(n),r},d.prototype.unregisterHandle=function(e,t,n){var r=this.linkHandles[e];if(void 0!==r){var i=r[t];if(void 0!==i){var o=-1;if(n instanceof Function){for(var s=0,a=i.length;a>s;s+=1)if(i[s].onEvent===n){o=s;break}}else o=i.indexOf(n);if(0>o)return!1;i.splice(o,1);var p=0===i.length;return p&&(delete r[t],0===Object.keys(r).length&&delete this.linkHandles[e]),p}}},d.prototype.sync=function(e,t,n){n=this.initHandle(n,!0);var r=this.registerHandle(e,t,n),i=new h.SyncRequest(this.unresolve(e),t);this.send(i),r&&(this.linkCount+=1)},d.prototype.link=function(e,t,n){n=this.initHandle(n,!1);var r=this.registerHandle(e,t,n);if(r){var i=new h.LinkRequest(this.unresolve(e),t);this.send(i),this.linkCount+=1}else if(this.socket.readyState===this.socket.OPEN){var o=n.__swim_link_state__;o.status=g,"function"==typeof n.onLinked&&n.onLinked.call(n,e,t)}},d.prototype.unlink=function(e,t,n){var r=this.unregisterHandle(e,t,n);if(r){var i=new h.UnlinkRequest(this.unresolve(e),t);
this.send(i),this.linkCount-=1}},d.prototype.unlinkAll=function(){for(var e in this.linkHandles){var t=this.linkHandles[e];for(var n in t)for(var r=t[n],i=0,o=r.length;o>i;i+=1){var s=r[i],a=s.__swim_link_state__;"function"==typeof s.onFailed&&s.onFailed.call(s,e,n),a.status=b}}this.linkCount=0,this.linkHandles={}},d.prototype.sendEvent=function(e,t,n){var r=new h.EventMessage(this.unresolve(e),t,void 0,n);this.send(r)},d.prototype.sendCommand=function(e,t,n){var r=new h.CommandMessage(this.unresolve(e),t,void 0,n);this.send(r)},d.prototype.get=function(e,t){"function"==typeof t&&(t={onState:t});var n=this.stateHandles[e];void 0===n&&(n=[],this.stateHandles[e]=n),n.push(t);var r=new h.GetRequest(this.unresolve(e));this.send(r)},d.prototype.put=function(e,t,n){void 0===n&&(n=r),"function"==typeof n&&(n={onState:n});var i=this.stateHandles[e];void 0===i&&(i=[],this.stateHandles[e]=i),i.push(n);var o=new h.PutRequest(this.unresolve(e),t);this.send(o)},d.prototype.onReceive=function(e){e.isEventMessage?this.onMessage(e):e.isCommandMessage?this.onMessage(e):e.isStateResponse?this.onState(e):e.isSyncedResponse?this.onSynced(e):e.isLinkedResponse?this.onLinked(e):e.isUnlinkedResponse&&this.onUnlinked(e)},d.prototype.onMessage=function(e){var t=y.resolve(this.node,e.node),n=this.linkHandles[t];if(void 0!==n)for(var r=e.lane;r;){var i=n[r];if(i)for(var o=0,s=i.length;s>o;o+=1){var a=i[o];e.isEventMessage?"function"==typeof a.onEvent&&a.onEvent.call(a,e):e.isCommandMessage&&"function"==typeof a.onCommand&&a.onCommand.call(a,e)}r=d.parentLane(r)}},d.prototype.onState=function(e){for(var t,n=y.resolve(this.node,e.node),r=this.stateHandles[n]||[];t=r.shift();)t.onState(e);delete this.stateHandles[n]},d.prototype.onSynced=function(e){var t=y.resolve(this.node,e.node),n=e.lane,r=this.linkHandles[t];if(void 0!==r){var i=r[n];if(void 0!==i)for(var o=0,s=i.length;s>o;o+=1){var a=i[o];a.onSynced(t,n)}}},d.prototype.onLinked=function(e){var t=y.resolve(this.node,e.node),n=e.lane,r=this.linkHandles[t];if(void 0!==r){var i=r[n];if(void 0!==i)for(var o=0,s=i.length;s>o;o+=1){var a=i[o],p=a.__swim_link_state__;p.status===E?"function"==typeof a.onUnbroken&&a.onUnbroken.call(a,t,n):"function"==typeof a.onLinked&&a.onLinked.call(a,t,n),p.status=g}}},d.prototype.onUnlinked=function(e){var t=y.resolve(this.node,e.node),n=e.lane,r=this.linkHandles[t];if(void 0!==r){var i=r[n];if(void 0!==i){for(var o=0,s=i.length;s>o;o+=1){var a=i[o],p=a.__swim_link_state__;p.status===g?("function"==typeof a.onUnlinked&&a.onUnlinked.call(a,t,n),p.status=w):("function"==typeof a.onFailed&&a.onFailed.call(a,t,n),p.status=b)}delete r[n],0===Object.keys(r).length&&delete this.linkHandles[t],this.linkCount-=1}}},d.prototype.unresolve=function(e){var t=y.parse(e);return y.serialize({path:t.path,query:t.query,fragment:t.fragment})},d.bridge={},d.get=function(e){var t=d.endpoint(e),n=d.bridge[t];return void 0===n&&(n=new d(t)),n},d.auth=function(e,t){var n=d.endpoint(e),r=d.bridge[n];return void 0===r&&(r=new d(n,t)),r},d.endpoint=function(e){var t=y.parse(e),n=t.scheme;return"swim"===n?n="http":"swims"===n&&(n="https"),y.serialize({scheme:n,userinfo:t.userinfo,host:t.host,port:t.port})},d.parentLane=function(e){var t=y.parse(e),n=t.path;if(t.query&&t.fragment)return y.serialize({path:n,query:t.query});if(t.query)return y.serialize({path:n});if(n.length>0){if(47===n.charCodeAt(n.length-1))return n=n.substring(0,n.length-1),y.serialize({path:n});var r=n.lastIndexOf("/");if(r>0)return n=n.substring(0,r+1),y.serialize({path:n})}},n.auth=i,n.sync=o,n.link=s,n.unlink=a,n.sendEvent=p,n.sendCommand=u,n.get=l,n.put=c,n.reset=f,n.options=m},{"swim-proto-js":2,"uri-js":8,websocket:9}]},{},[12])(12)});
//# sourceMappingURL=swim-client.min.js.map